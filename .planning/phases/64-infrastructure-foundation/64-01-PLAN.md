---
phase: 64-infrastructure-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/lib/eda/technique-content.ts
  - src/lib/eda/technique-content/index.ts
  - src/lib/eda/technique-content/types.ts
  - src/lib/eda/technique-content/time-series.ts
  - src/lib/eda/technique-content/distribution-shape.ts
  - src/lib/eda/technique-content/comparison.ts
  - src/lib/eda/technique-content/regression.ts
  - src/lib/eda/technique-content/designed-experiments.ts
  - src/lib/eda/technique-content/multivariate.ts
  - src/lib/eda/technique-content/combined-diagnostic.ts
autonomous: true
requirements:
  - INFRA-01
  - INFRA-02

must_haves:
  truths:
    - "getTechniqueContent('autocorrelation-plot') returns the same content as before the split"
    - "All 29 graphical technique pages render identically after the split"
    - "Adding a questions array to any technique entry compiles without error"
    - "Adding formulas, pythonCode, caseStudySlugs, importance, definitionExpanded, or examples to any entry compiles without error"
  artifacts:
    - path: "src/lib/eda/technique-content/types.ts"
      provides: "Extended TechniqueContent interface with 7 optional fields"
      exports: ["TechniqueContent"]
      contains: "questions.*string\\[\\]"
    - path: "src/lib/eda/technique-content/index.ts"
      provides: "Barrel re-export preserving public API"
      exports: ["getTechniqueContent", "TechniqueContent"]
    - path: "src/lib/eda/technique-content/time-series.ts"
      provides: "5 time-series technique entries"
      exports: ["TIME_SERIES_CONTENT"]
    - path: "src/lib/eda/technique-content/distribution-shape.ts"
      provides: "9 distribution-shape technique entries"
      exports: ["DISTRIBUTION_SHAPE_CONTENT"]
    - path: "src/lib/eda/technique-content/comparison.ts"
      provides: "4 comparison technique entries"
      exports: ["COMPARISON_CONTENT"]
    - path: "src/lib/eda/technique-content/regression.ts"
      provides: "3 regression technique entries"
      exports: ["REGRESSION_CONTENT"]
    - path: "src/lib/eda/technique-content/designed-experiments.ts"
      provides: "2 designed-experiments technique entries"
      exports: ["DESIGNED_EXPERIMENTS_CONTENT"]
    - path: "src/lib/eda/technique-content/multivariate.ts"
      provides: "3 multivariate technique entries"
      exports: ["MULTIVARIATE_CONTENT"]
    - path: "src/lib/eda/technique-content/combined-diagnostic.ts"
      provides: "3 combined-diagnostic technique entries"
      exports: ["COMBINED_DIAGNOSTIC_CONTENT"]
  key_links:
    - from: "src/lib/eda/technique-content/index.ts"
      to: "src/lib/eda/technique-content/types.ts"
      via: "import type { TechniqueContent }"
      pattern: "import type.*TechniqueContent.*from.*types"
    - from: "src/lib/eda/technique-content/index.ts"
      to: "7 category files"
      via: "spread into TECHNIQUE_CONTENT record"
      pattern: "\\.\\.\\.TIME_SERIES_CONTENT"
    - from: "src/pages/eda/techniques/[slug].astro"
      to: "src/lib/eda/technique-content/index.ts"
      via: "import getTechniqueContent (unchanged path resolution)"
      pattern: "from.*lib/eda/technique-content"
---

<objective>
Split the 64KB technique-content.ts monolith into per-category modules and extend the TechniqueContent interface with 7 new optional fields, preserving the existing public API.

Purpose: Prevents the file from growing to 200KB+ when content is added in Phases 66-67, and enables the new content fields (questions, formulas, pythonCode, etc.) that the template will render.
Output: 10 new files in src/lib/eda/technique-content/ directory, original monolith deleted. Build passes identically.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/64-infrastructure-foundation/64-RESEARCH.md

@src/lib/eda/technique-content.ts
@src/pages/eda/techniques/[slug].astro
@src/pages/eda/quantitative/[slug].astro
@src/lib/eda/quantitative-content.ts

<interfaces>
<!-- Current public API that MUST be preserved after split -->

From src/lib/eda/technique-content.ts:
```typescript
export interface TechniqueContent {
  definition: string;
  purpose: string;
  interpretation: string;
  assumptions: string;
  nistReference: string;
}

export function getTechniqueContent(slug: string): TechniqueContent | undefined;
```

From src/pages/eda/techniques/[slug].astro (consumer):
```typescript
import { getTechniqueContent } from '../../../lib/eda/technique-content';
// ...
const content = getTechniqueContent(technique.slug);
```

From src/lib/eda/quantitative-content.ts (precedent for formulas/pythonCode fields):
```typescript
interface QuantitativeContent {
  // ... base fields ...
  formulas: Array<{ label: string; tex: string; explanation: string }>;
  pythonCode: string;
}
```
</interfaces>
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create types.ts with extended TechniqueContent interface</name>
  <files>src/lib/eda/technique-content/types.ts</files>
  <action>
Create `src/lib/eda/technique-content/types.ts` with the extended TechniqueContent interface. This is the contract file that all other files in this plan import from.

The interface MUST keep the 5 existing required fields unchanged (definition, purpose, interpretation, assumptions, nistReference) and ADD 7 new OPTIONAL fields:

```typescript
questions?: string[];
importance?: string;
definitionExpanded?: string;
formulas?: Array<{ label: string; tex: string; explanation: string }>;
pythonCode?: string;
caseStudySlugs?: string[];
examples?: Array<{ label: string; description: string; variantLabel?: string }>;
```

Include JSDoc comments on each field. Add a comment on the `tex` field: `/** KaTeX display-mode formula (MUST use String.raw) */`.

Do NOT create a new interface name (no TechniqueContentV2). Extend the existing interface in place.

Follow project conventions: named export, PascalCase for the interface name, 2-space indentation.
  </action>
  <verify>
Run `npx tsc --noEmit src/lib/eda/technique-content/types.ts` to verify the file compiles. Also run `grep -c 'questions\|importance\|definitionExpanded\|formulas\|pythonCode\|caseStudySlugs\|examples' src/lib/eda/technique-content/types.ts` -- expect 7 matches.
  </verify>
  <done>types.ts exists with TechniqueContent interface containing all 5 original required fields and 7 new optional fields, compiles cleanly</done>
</task>

<task type="auto">
  <name>Task 2: Split technique-content.ts into 7 category files + barrel index</name>
  <files>
src/lib/eda/technique-content/time-series.ts
src/lib/eda/technique-content/distribution-shape.ts
src/lib/eda/technique-content/comparison.ts
src/lib/eda/technique-content/regression.ts
src/lib/eda/technique-content/designed-experiments.ts
src/lib/eda/technique-content/multivariate.ts
src/lib/eda/technique-content/combined-diagnostic.ts
src/lib/eda/technique-content/index.ts
src/lib/eda/technique-content.ts
  </files>
  <action>
Split the existing monolith `src/lib/eda/technique-content.ts` (64KB, 29 entries) into 7 category files plus a barrel index.

**Step 1: Read the full technique-content.ts** to get all 29 entries.

**Step 2: Create 7 category files.** Each file:
- Imports `type { TechniqueContent }` from `'./types'`
- Exports a `Record<string, TechniqueContent>` constant (SCREAMING_SNAKE_CASE per convention)
- Contains the technique entries assigned to that category

Category assignments (from research):
- `time-series.ts` (5): autocorrelation-plot, complex-demodulation, lag-plot, run-sequence-plot, spectral-plot
- `distribution-shape.ts` (9): bihistogram, bootstrap-plot, box-cox-linearity, box-cox-normality, box-plot, histogram, normal-probability-plot, probability-plot, qq-plot
- `comparison.ts` (4): block-plot, mean-plot, star-plot, youden-plot
- `regression.ts` (3): linear-plots, scatter-plot, 6-plot
- `designed-experiments.ts` (2): doe-plots, std-deviation-plot
- `multivariate.ts` (3): contour-plot, scatterplot-matrix, conditioning-plot
- `combined-diagnostic.ts` (3): ppcc-plot, weibull-plot, 4-plot

**Step 3: Create barrel index.ts.** This file:
- Imports all 7 category constants
- Spreads them into a single `TECHNIQUE_CONTENT` record
- Re-exports `getTechniqueContent()` with the EXACT same signature: `(slug: string) => TechniqueContent | undefined`
- Re-exports the `TechniqueContent` type: `export type { TechniqueContent } from './types'`

**Step 4: DELETE the original `src/lib/eda/technique-content.ts` file.** This is CRITICAL -- TypeScript cannot have both `technique-content.ts` and `technique-content/index.ts` at the same import path. Delete the file BEFORE testing the build.

**Step 5: Verify the build.**

IMPORTANT: The import in `src/pages/eda/techniques/[slug].astro` (`from '../../../lib/eda/technique-content'`) MUST resolve to the new `technique-content/index.ts` without any changes to the import path. TypeScript resolves `technique-content` to `technique-content/index.ts` automatically -- but ONLY if `technique-content.ts` no longer exists.

Do NOT modify any files outside the technique-content directory (no changes to [slug].astro or any other consumer).
  </action>
  <verify>
Run `npx astro build 2>&1 | tail -20` -- build must succeed with zero errors. Then verify all 29 techniques are present: `grep -c "'" src/lib/eda/technique-content/index.ts` should show the 7 import lines. Also verify the old file is gone: `test -f src/lib/eda/technique-content.ts && echo "ERROR: old file still exists" || echo "OK: old file deleted"`.
  </verify>
  <done>Original technique-content.ts is deleted. 7 category files + types.ts + index.ts exist in src/lib/eda/technique-content/. `astro build` passes. All 29 graphical technique pages render identically to before the split (same HTML output).</done>
</task>

</tasks>

<verification>
1. `npx astro build` completes with zero errors
2. `ls src/lib/eda/technique-content/` shows: types.ts, index.ts, time-series.ts, distribution-shape.ts, comparison.ts, regression.ts, designed-experiments.ts, multivariate.ts, combined-diagnostic.ts (9 files)
3. `test -f src/lib/eda/technique-content.ts` returns false (old monolith deleted)
4. `grep -rn "getTechniqueContent" src/pages/eda/techniques/` still shows the same import path (unchanged)
</verification>

<success_criteria>
- technique-content.ts monolith is gone, replaced by technique-content/ directory with 9 files
- Public API (getTechniqueContent function + TechniqueContent type) is unchanged
- TechniqueContent interface has 7 new optional fields (questions, importance, definitionExpanded, formulas, pythonCode, caseStudySlugs, examples)
- `astro build` passes with zero errors
- No consumer files were modified (the split is transparent)
</success_criteria>

<output>
After completion, create `.planning/phases/64-infrastructure-foundation/64-01-SUMMARY.md`
</output>
