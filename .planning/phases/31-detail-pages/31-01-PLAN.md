---
phase: 31-detail-pages
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/db-compass/ModelNav.astro
  - src/pages/tools/db-compass/[slug].astro
autonomous: true
requirements: [PAGE-02, PAGE-03, PAGE-04, SEO-02]

must_haves:
  truths:
    - "Visiting /tools/db-compass/key-value/ renders a complete detail page with radar chart, score breakdown, CAP badge, when-to-use/avoid lists, dimension analysis, top databases, and character sketch"
    - "All 12 model detail pages are generated via getStaticPaths from the dbModels content collection"
    - "Each detail page has prev/next navigation links ordered by complexityPosition (key-value first, multi-model last)"
    - "Each detail page has JSON-LD CreativeWork with aggregateRating and BreadcrumbList structured data"
    - "Each detail page has an SEO-optimized meta description under 155 characters"
  artifacts:
    - path: "src/components/db-compass/ModelNav.astro"
      provides: "Prev/next navigation between detail pages by complexity position"
      min_lines: 30
    - path: "src/pages/tools/db-compass/[slug].astro"
      provides: "12 model detail pages with all content sections and SEO"
      min_lines: 150
  key_links:
    - from: "src/pages/tools/db-compass/[slug].astro"
      to: "astro:content getCollection('dbModels')"
      via: "getStaticPaths with complexityPosition sort"
      pattern: "getCollection.*dbModels"
    - from: "src/pages/tools/db-compass/[slug].astro"
      to: "src/components/db-compass/CompassRadarChart.astro"
      via: "Astro component import"
      pattern: "import CompassRadarChart"
    - from: "src/pages/tools/db-compass/[slug].astro"
      to: "src/components/db-compass/ModelNav.astro"
      via: "Astro component import with prev/next props"
      pattern: "import ModelNav"
    - from: "src/pages/tools/db-compass/[slug].astro"
      to: "JSON-LD CreativeWork inline script"
      via: "Inline script tag in head"
      pattern: "CreativeWork"
---

<objective>
Create 12 model detail pages at /tools/db-compass/[slug]/ with complete content sections and prev/next navigation.

Purpose: These pages are the core deliverable of Database Compass -- each page gives a developer everything they need to understand a database model's strengths, tradeoffs, and top implementations.
Output: ModelNav.astro component + [slug].astro page generating 12 detail routes
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/31-detail-pages/31-RESEARCH.md

@src/pages/beauty-index/[slug].astro
@src/components/beauty-index/LanguageNav.astro
@src/components/db-compass/CompassRadarChart.astro
@src/components/db-compass/CompassScoreBreakdown.astro
@src/components/db-compass/CapBadge.astro
@src/components/BreadcrumbJsonLd.astro
@src/lib/db-compass/dimensions.ts
@src/lib/db-compass/schema.ts
@src/layouts/Layout.astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ModelNav prev/next navigation component</name>
  <files>src/components/db-compass/ModelNav.astro</files>
  <action>
Create ModelNav.astro by adapting LanguageNav.astro (51 lines) for Database Compass.

Props interface:
- prev: { slug: string; name: string } | null
- next: { slug: string; name: string } | null

Structure: Three-column flexbox nav with aria-label="Model navigation"
- Left: prev link to /tools/db-compass/${prev.slug}/ with left arrow, or empty span if null
- Center: "Overview" link to /tools/db-compass/
- Right: next link to /tools/db-compass/${next.slug}/ with right arrow, or empty span if null

Styling: Use same Tailwind classes as LanguageNav.astro -- flex items-center justify-between, mt-12 pt-6, border-t border-[var(--color-border)], accent color links with hover:underline.

IMPORTANT: Render empty `<span />` when prev or next is null to maintain flexbox three-column layout (prevents "Overview" from shifting).
  </action>
  <verify>File exists at src/components/db-compass/ModelNav.astro. Run `npx astro check 2>&1 | grep -i "db-compass"` to confirm zero type errors in db-compass files.</verify>
  <done>ModelNav.astro accepts prev/next props and renders three-column navigation with empty span placeholders for null values.</done>
</task>

<task type="auto">
  <name>Task 2: Create [slug].astro detail page with all content sections and SEO</name>
  <files>src/pages/tools/db-compass/[slug].astro</files>
  <action>
Create [slug].astro following the Beauty Index [slug].astro pattern (257 lines). This is a composition exercise -- all components exist, all data fields exist.

**getStaticPaths:**
- Import getCollection from 'astro:content'
- Load dbModels collection, extract .data from each entry
- Sort by complexityPosition ascending (key-value 0.08 first, multi-model 0.88 last)
- Map to params/props with prev/next computed from sorted array index
- prev is null for index 0, next is null for last index

**Imports (all existing components):**
- Layout from '../../../layouts/Layout.astro'
- BreadcrumbJsonLd from '../../../components/BreadcrumbJsonLd.astro'
- CompassRadarChart from '../../../components/db-compass/CompassRadarChart.astro'
- CompassScoreBreakdown from '../../../components/db-compass/CompassScoreBreakdown.astro'
- CapBadge from '../../../components/db-compass/CapBadge.astro'
- ModelNav from '../../../components/db-compass/ModelNav.astro'
- DIMENSIONS, DIMENSION_COLORS from '../../../lib/db-compass/dimensions'
- totalScore from '../../../lib/db-compass/schema'

**SEO meta description (under 155 chars):**
```typescript
const total = totalScore(model);
const capLabel = model.capTheorem.classification;
const fullDesc = `${model.name} scores ${total}/80 in the Database Compass. ${capLabel} classification. ${model.summary}`;
const metaDescription = fullDesc.length <= 155 ? fullDesc : fullDesc.slice(0, 155).replace(/\s+\S*$/, '') + '...';
```

**JSON-LD CreativeWork (inline in head, SEO-02):**
Use the exact schema from 31-RESEARCH.md Pattern 5. Include:
- @type: CreativeWork
- name: "${model.name} -- Database Compass Score"
- description: metaDescription
- url: full URL
- datePublished/dateModified: "2026-02-22"
- author: Person with @id
- isPartOf: Dataset linking to /tools/db-compass/
- aggregateRating: total/80

**BreadcrumbJsonLd:**
Crumbs: Home > Tools > Database Compass > {model.name}

**Layout wrapper:**
`<Layout title={`${model.name} -- Database Compass`} description={metaDescription}>`

**Page sections (in order):**
1. **Header area:** h1 with model.name, subtitle with model.summary, CapBadge inline
2. **Radar chart:** CompassRadarChart with model prop, wrapped in a container with id="radar-chart" (needed for future share controls SVG capture)
3. **Score breakdown:** CompassScoreBreakdown with model prop
4. **Character sketch:** h2 "Character", paragraph with model.characterSketch
5. **When to use:** h2 "When to Use", ul mapping model.bestFor with checkmark icons (use &#10003; span with text-[var(--color-accent)])
6. **Avoid when:** h2 "Avoid When", ul mapping model.avoidWhen with X icons (use &#10007; span with text-red-500)
7. **Dimension analysis:** h2 "Dimension Analysis", map DIMENSIONS to show symbol + name + score/10 + justification text per dimension. Use DIMENSION_COLORS for symbol color.
8. **Top databases:** h2 "Top Databases", map model.topDatabases to cards with name (external link), license badge, description
9. **Placeholder comment for share controls:** Add HTML comment `<!-- CompassShareControls will be added in Plan 02 -->` where share controls will go (between score breakdown and character sketch sections)
10. **ModelNav:** prev/next navigation at bottom

**Section id attributes (for future deep linking):**
Add id="when-to-use", id="avoid-when", id="dimension-analysis", id="top-databases" to major section headings.

**Styling patterns:**
- Use same Tailwind utility patterns as Beauty Index [slug].astro
- max-w-3xl mx-auto for content width
- Sections separated by mt-12
- Headings: text-xl font-heading font-bold mb-4 (or mb-6 for dimension analysis)
- Text: text-[var(--color-text-secondary)] for body content
- External links: text-[var(--color-accent)] hover:underline with target="_blank" rel="noopener noreferrer"

Do NOT create a React island. This page is entirely server-rendered Astro components.
  </action>
  <verify>Run `npm run build 2>&1 | tail -5` and confirm build succeeds (should produce 12 new pages, total ~727 pages). Verify one page exists: `ls dist/tools/db-compass/key-value/index.html`. Run `npx astro check 2>&1 | grep -c "error"` returns 0.</verify>
  <done>12 detail pages render at /tools/db-compass/[slug]/ with radar chart, score breakdown, CAP badge, character sketch, when-to-use/avoid lists, dimension analysis, top databases, prev/next navigation, JSON-LD CreativeWork, BreadcrumbList, and SEO meta description.</done>
</task>

</tasks>

<verification>
1. `npm run build` succeeds with ~727 pages (715 existing + 12 new detail pages)
2. `ls dist/tools/db-compass/*/index.html | wc -l` returns 13 (1 overview + 12 detail pages)
3. `grep -l "CreativeWork" dist/tools/db-compass/key-value/index.html` confirms JSON-LD present
4. `grep -l "BreadcrumbList" dist/tools/db-compass/relational/index.html` confirms breadcrumbs
5. `npx astro check` has zero db-compass errors
</verification>

<success_criteria>
- All 12 detail pages build and render with complete content sections
- Prev/next navigation works across all 12 pages in complexity order
- JSON-LD CreativeWork and BreadcrumbList present on every detail page
- Meta descriptions are under 155 characters with model-specific content
- Build produces ~727 pages with zero errors
</success_criteria>

<output>
After completion, create `.planning/phases/31-detail-pages/31-01-SUMMARY.md`
</output>
