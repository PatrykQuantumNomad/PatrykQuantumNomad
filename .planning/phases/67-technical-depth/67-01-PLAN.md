---
phase: 67-technical-depth
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/lib/eda/technique-content/time-series.ts
  - src/lib/eda/technique-content/combined-diagnostic.ts
autonomous: true
requirements: [DEFN-02, PYTH-01, PYTH-02, PYTH-03, PYTH-04]

must_haves:
  truths:
    - "All 5 time-series technique pages display syntax-highlighted Python code examples"
    - "All 3 combined-diagnostic technique pages display syntax-highlighted Python code examples"
    - "autocorrelation-plot and spectral-plot pages display KaTeX-rendered formulas"
    - "ppcc-plot, weibull-plot, and 4-plot pages display KaTeX-rendered formulas"
    - "No deprecated Python APIs appear in any code example"
    - "All Python examples are self-contained with imports and sample data generation"
  artifacts:
    - path: "src/lib/eda/technique-content/time-series.ts"
      provides: "formulas (2 techniques) + pythonCode (5 techniques)"
      contains: "pythonCode"
    - path: "src/lib/eda/technique-content/combined-diagnostic.ts"
      provides: "formulas (3 techniques) + pythonCode (3 techniques)"
      contains: "pythonCode"
  key_links:
    - from: "src/lib/eda/technique-content/time-series.ts"
      to: "src/pages/eda/techniques/[slug].astro"
      via: "getTechniqueContent() barrel export"
      pattern: "formulas.*String\\.raw"
    - from: "src/lib/eda/technique-content/combined-diagnostic.ts"
      to: "src/pages/eda/techniques/[slug].astro"
      via: "getTechniqueContent() barrel export"
      pattern: "pythonCode"
---

<objective>
Add KaTeX formulas and Python code examples to all 8 techniques in the time-series and combined-diagnostic category files.

Purpose: 5 of the 12 NIST formula techniques (autocorrelation, spectral, ppcc, weibull, 4-plot) and 8 of the 29 Python code examples live in these two files. Completing them in one plan keeps the formula-heavy content together.
Output: time-series.ts with 2 formulas + 5 pythonCode entries, combined-diagnostic.ts with 3 formulas + 3 pythonCode entries
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/67-technical-depth/67-RESEARCH.md

@src/lib/eda/technique-content/types.ts
@src/lib/eda/technique-content/time-series.ts
@src/lib/eda/technique-content/combined-diagnostic.ts
@src/lib/eda/quantitative-content.ts

<interfaces>
From src/lib/eda/technique-content/types.ts:
```typescript
formulas?: Array<{
  label: string;
  tex: string;       // KaTeX display-mode formula (MUST use String.raw)
  explanation: string;
}>;
pythonCode?: string;  // Complete Python example
```

Pattern from quantitative-content.ts:
```typescript
formulas: [
  {
    label: 'Sample Mean',
    tex: String.raw`\bar{x} = \frac{1}{n}\sum_{i=1}^{n} x_i`,
    explanation: 'The arithmetic average of all n observations.',
  },
],
pythonCode: `import numpy as np
import matplotlib.pyplot as plt
...
plt.show()`,
```
</interfaces>
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add formulas and pythonCode to 5 time-series techniques</name>
  <files>src/lib/eda/technique-content/time-series.ts</files>
  <action>
Add `formulas` and `pythonCode` fields to each of the 5 technique entries in time-series.ts. Place these fields AFTER the existing content fields (after `examples` or `caseStudySlugs` or `definitionExpanded`, whichever is last for that technique).

**autocorrelation-plot** (formulas + pythonCode):
- formulas: 3 entries from NIST 1.3.3.1
  1. Autocovariance Function: C_h = (1/N) sum (Y_t - Y_bar)(Y_{t+h} - Y_bar)
  2. Autocorrelation Coefficient: R_h = C_h / C_0
  3. 95% Significance Bounds: +/- 2/sqrt(N) (use 2/sqrt(N) per Phase 65 decision for NIST consistency, NOT 1.96/sqrt(N))
- pythonCode: Use `statsmodels.graphics.tsaplots.plot_acf()` (NOT `plt.acorr()`). Generate AR(1) data with `np.random.default_rng(42)`. ~15-20 lines.

**spectral-plot** (formulas + pythonCode):
- formulas: 2 entries from NIST 1.3.3.27
  1. Power Spectral Density via periodogram
  2. Frequency range (0 to Nyquist)
- pythonCode: Use `scipy.signal.periodogram()`. Generate sinusoidal + noise data. ~15-20 lines.

**complex-demodulation** (pythonCode only, no formulas):
- pythonCode: Use `scipy.signal.hilbert()` to compute analytic signal, extract amplitude envelope. Generate sinusoidal signal with time-varying amplitude. Allow up to 25-30 lines per research open question. No `${}` interpolation issues -- check for Python f-strings.

**lag-plot** (pythonCode only):
- pythonCode: Manual scatter plot `plt.scatter(y[:-1], y[1:])`. Generate AR(1) data. ~12-15 lines.

**run-sequence-plot** (pythonCode only):
- pythonCode: `plt.plot(range(n), data)` with horizontal mean line. Generate normal data. ~12-15 lines.

CRITICAL RULES:
- ALL `tex` values MUST use `String.raw` template literals
- ALL Python examples MUST use `np.random.default_rng(42)` for reproducibility (not `np.random.seed()`)
- Do NOT use `plt.acorr()`, `distplot`, `vert=True`, `normed=True`, or `random_state=`
- Each example MUST import all libraries used and generate its own sample data
- Target 15-35 lines per example (complex-demodulation may go to 30)
  </action>
  <verify>
npx astro build 2>&1 | tail -5
# Must show zero errors and all pages built
grep -c 'pythonCode' src/lib/eda/technique-content/time-series.ts
# Must return 5 (one per technique)
grep -c 'String.raw' src/lib/eda/technique-content/time-series.ts
# Must return at least 5 (formulas for autocorrelation + spectral)
grep -n 'distplot\|vert=True\|normed=True\|plt\.acorr(\|random_state=' src/lib/eda/technique-content/time-series.ts
# Must return zero matches
  </verify>
  <done>All 5 time-series techniques have pythonCode strings. autocorrelation-plot has 3 formulas and spectral-plot has 2 formulas. Build passes cleanly. No deprecated Python APIs present.</done>
</task>

<task type="auto">
  <name>Task 2: Add formulas and pythonCode to 3 combined-diagnostic techniques</name>
  <files>src/lib/eda/technique-content/combined-diagnostic.ts</files>
  <action>
Add `formulas` and `pythonCode` fields to each of the 3 technique entries in combined-diagnostic.ts. Place these fields AFTER the existing content fields.

**ppcc-plot** (formulas + pythonCode):
- formulas: 2 entries from NIST 1.3.3.23
  1. Probability Plot Correlation Coefficient (PPCC): correlation between ordered data and theoretical quantiles
  2. PPCC as function of shape parameter (the curve that is plotted)
- pythonCode: Use `scipy.stats.ppcc_plot()`. Generate right-skewed data. ~15-18 lines.

**weibull-plot** (formulas + pythonCode):
- formulas: 2 entries from NIST 1.3.3.30
  1. Weibull CDF linearization: ln(-ln(1-F(t))) = beta*ln(t) - beta*ln(eta)
  2. Plotting position: F_i = (i - 0.3)/(N + 0.4) (Benard's approximation)
- pythonCode: Use `scipy.stats.probplot(dist='weibull_min', sparams=(shape,))`. Generate Weibull data. ~15-20 lines.

**4-plot** (formulas + pythonCode):
- formulas: 1 entry -- the 4-plot is a diagnostic composite, its formula is the ensemble definition (run-sequence + lag + histogram + normal-probability in 2x2 grid)
  1. 4-Plot definition: Y_i vs i, Y_i vs Y_{i-1}, histogram, normal probability plot
- pythonCode: 2x2 subplot grid using `plt.subplots(2, 2)`. Panel 1: run sequence. Panel 2: lag plot. Panel 3: histogram (`density=True`, NOT `normed=True`). Panel 4: normal probability plot via `scipy.stats.probplot()`. ~25-30 lines.

CRITICAL RULES:
- ALL `tex` values MUST use `String.raw` template literals
- ALL Python examples MUST use `np.random.default_rng(42)`
- Do NOT use deprecated APIs
- histogram panel in 4-plot MUST use `density=True` not `normed=True`
  </action>
  <verify>
npx astro build 2>&1 | tail -5
# Must show zero errors
grep -c 'pythonCode' src/lib/eda/technique-content/combined-diagnostic.ts
# Must return 3
grep -c 'String.raw' src/lib/eda/technique-content/combined-diagnostic.ts
# Must return at least 5 (formulas for ppcc + weibull + 4-plot)
grep -n 'distplot\|vert=True\|normed=True\|plt\.acorr(\|random_state=' src/lib/eda/technique-content/combined-diagnostic.ts
# Must return zero matches
  </verify>
  <done>All 3 combined-diagnostic techniques have pythonCode strings. ppcc-plot has 2 formulas, weibull-plot has 2 formulas, 4-plot has 1 formula. Build passes cleanly. No deprecated APIs.</done>
</task>

</tasks>

<verification>
After both tasks complete:
1. `npx astro build` passes with zero errors
2. `grep -c 'pythonCode' src/lib/eda/technique-content/time-series.ts` returns 5
3. `grep -c 'pythonCode' src/lib/eda/technique-content/combined-diagnostic.ts` returns 3
4. `grep -rn 'distplot\|vert=True\|normed=True\|plt\.acorr(\|random_state=' src/lib/eda/technique-content/time-series.ts src/lib/eda/technique-content/combined-diagnostic.ts` returns zero matches
5. `grep -c 'String.raw' src/lib/eda/technique-content/time-series.ts` returns at least 5
6. `grep -c 'String.raw' src/lib/eda/technique-content/combined-diagnostic.ts` returns at least 5
</verification>

<success_criteria>
- 8 techniques across 2 files have pythonCode fields with self-contained, syntax-highlighted Python examples
- 5 techniques have KaTeX formula arrays with String.raw tex strings matching NIST definitions
- Zero deprecated Python API patterns found via grep
- astro build passes with zero errors
</success_criteria>

<output>
After completion, create `.planning/phases/67-technical-depth/67-01-SUMMARY.md`
</output>
