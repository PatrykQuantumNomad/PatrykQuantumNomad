---
phase: 57-minor-gap-case-studies
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/data/eda/pages/case-studies/filter-transmittance.mdx
autonomous: true
requirements: [FILT-01, FILT-02, FILT-03]

must_haves:
  truths:
    - "Filter Transmittance has all 7 canonical graphical subsections: 4-Plot Overview, Run Sequence Plot, Lag Plot, Histogram, Normal Probability Plot, Autocorrelation Plot, Spectral Plot"
    - "All graphical subsection headings use canonical names without 'Fixed Location --' or 'Randomness --' prefixes"
    - "Filter Transmittance uses canonical heading '## Quantitative Output and Interpretation' (not '## Quantitative Results')"
    - "Histogram and Normal Probability Plot subsections include caveats about limited meaningfulness due to autocorrelation"
    - "Filter Transmittance has a ## Interpretation section between Test Summary and Conclusions"
    - "The lag-1 autocorrelation value (r1) is verified against the computed value from the dataset"
  artifacts:
    - path: "src/data/eda/pages/case-studies/filter-transmittance.mdx"
      provides: "Complete Filter Transmittance case study with canonical headings, all 7 plot subsections, and Interpretation section"
      contains: "## Interpretation"
  key_links:
    - from: "filter-transmittance.mdx ### Histogram"
      to: "FilterTransmittancePlots component"
      via: "component invocation"
      pattern: "FilterTransmittancePlots type=\"histogram\""
    - from: "filter-transmittance.mdx ### Normal Probability Plot"
      to: "FilterTransmittancePlots component"
      via: "component invocation"
      pattern: "FilterTransmittancePlots type=\"probability\""
    - from: "filter-transmittance.mdx ## Interpretation"
      to: "technique and quantitative method pages"
      via: "cross-reference links"
      pattern: "/eda/(techniques|quantitative)/"
---

<objective>
Restructure the Filter Transmittance case study to match the canonical template: rename headings, add missing Histogram and Normal Probability Plot subsections, fix section headings, add Interpretation section, and verify the r1 autocorrelation value.

Purpose: Filter Transmittance has the most structural work of the four Phase 57 case studies. It currently uses non-standard heading names ("### Fixed Location -- Run Sequence Plot" instead of "### Run Sequence Plot"), is missing standalone Histogram and Normal Probability Plot subsections, uses "## Quantitative Results" instead of the canonical heading, and lacks an Interpretation section. This plan brings it to full canonical compliance and NIST parity.

Output: Filter Transmittance MDX file with all 7 canonical graphical subsections, canonical headings, and complete Interpretation section.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/57-minor-gap-case-studies/57-RESEARCH.md
@.planning/phases/56-infrastructure-foundation/case-study-template.md
@.planning/phases/56-infrastructure-foundation/url-cross-reference.md
@.planning/phases/56-infrastructure-foundation/56-01-SUMMARY.md
@src/data/eda/pages/case-studies/filter-transmittance.mdx
@src/components/eda/FilterTransmittancePlots.astro
@src/lib/eda/math/statistics.ts
@src/data/eda/datasets.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rename headings and add Histogram and Normal Probability Plot subsections</name>
  <files>src/data/eda/pages/case-studies/filter-transmittance.mdx</files>
  <action>
1. **Rename graphical subsection headings** to canonical format:
   - `### Fixed Location — Run Sequence Plot` -> `### Run Sequence Plot`
   - `### Randomness — Lag Plot` -> `### Lag Plot`
   - `### Randomness — Autocorrelation Plot` -> `### Autocorrelation Plot`
   - `### Randomness — Spectral Plot` -> `### Spectral Plot`
   Note: The existing interpretation paragraphs already explain which assumption each plot tests, so no content is lost by removing the prefixes.

2. **Add ### Histogram subsection** after `### Lag Plot` and before `### Autocorrelation Plot` (to maintain the canonical order: 4-Plot, Run Sequence, Lag, Histogram, Probability, Autocorrelation, Spectral). Content:
   ```
   ### Histogram

   The [histogram](/eda/techniques/histogram/) shows the distribution of the 50 transmittance values. However, because the randomness assumption is severely violated (lag-1 autocorrelation r1 = 0.93), the histogram does not represent the distribution of independent errors. Instead, it reflects the combined effects of the autocorrelation structure and the location shift visible in the run sequence plot.

   <FilterTransmittancePlots type="histogram" />

   The histogram appears roughly symmetric, but this graphical assessment has limited interpretive value when the data are strongly autocorrelated. The shape is influenced by the drift and serial dependence rather than the underlying error distribution alone.
   ```

3. **Add ### Normal Probability Plot subsection** after `### Histogram` and before `### Autocorrelation Plot`. Content:
   ```
   ### Normal Probability Plot

   The [normal probability plot](/eda/techniques/normal-probability-plot/) assesses whether the data follow a normal distribution. As with the histogram, interpretation is limited because the severe autocorrelation violates the independence assumption required for distributional tests.

   <FilterTransmittancePlots type="probability" />

   The probability plot shows some curvature, but this cannot be reliably interpreted as evidence for or against normality when the observations are not independent. The distributional assessment is deferred until the randomness issue is resolved.
   ```

4. **Rename section heading** -- Change `## Quantitative Results` to `## Quantitative Output and Interpretation`.

5. **Verify the FilterTransmittancePlots component supports "histogram" and "probability" types** by reading the component file. If these types are not supported, note the issue and use the 4-plot's sub-panels as reference (the 4-plot already includes histogram and probability panels). If the types ARE supported (they should be since Phase 56 refactored all Plots components), use them.

6. **Do NOT modify** the content of existing subsections beyond the heading renames. Preserve all existing interpretation paragraphs, test result tables, and conclusions.
  </action>
  <verify>
Run `grep -n "^### " src/data/eda/pages/case-studies/filter-transmittance.mdx` to verify all 7 canonical subsection headings exist in order: 4-Plot Overview, Run Sequence Plot, Lag Plot, Histogram, Normal Probability Plot, Autocorrelation Plot, Spectral Plot. Run `grep "Fixed Location\|Randomness --" src/data/eda/pages/case-studies/filter-transmittance.mdx` to verify no old-format headings remain (should return nothing). Run `grep "## Quantitative Output" src/data/eda/pages/case-studies/filter-transmittance.mdx` to verify canonical heading.
  </verify>
  <done>
Filter Transmittance has all 7 canonical graphical subsections in correct order with canonical heading names. No "Fixed Location --" or "Randomness --" prefixes remain. The Histogram and Normal Probability Plot subsections include caveats about limited interpretive value due to autocorrelation. Section heading uses "## Quantitative Output and Interpretation".
  </done>
</task>

<task type="auto">
  <name>Task 2: Add Interpretation section, verify r1 value, and verify all test statistics</name>
  <files>src/data/eda/pages/case-studies/filter-transmittance.mdx</files>
  <action>
1. **Resolve r1 autocorrelation discrepancy** -- The MDX says r1 = 0.93, NIST says 0.94. Compute the actual value:
   - Import filter transmittance dataset from datasets.ts
   - Compute autocorrelation at lag 1 using the autocorrelation function from statistics.ts (or read the Plots component to find the computed value)
   - If the computed value rounds to 0.94, update MDX. If it rounds to 0.93, keep the MDX value. NIST values are the authority, but the computed value from the exact dataset array takes precedence when available.
   - Update the r1 value in ALL places it appears: Summary Statistics table, Randomness Tests section, and Test Summary table.

2. **Verify all other test statistic values** match NIST:
   - Location test: t = 5.582 (NIST: drift significant) -- MUST match
   - Levene test: W = 0.971 (NIST: no significant change) -- MUST match
   - Runs test: Z = -5.3246 (NIST: not random) -- MUST match
   - Mean: 2.0019, Std Dev: 0.0004 (NIST source) -- MUST match

3. **Add ## Interpretation section** between the "### Test Summary" subsection and "## Root Cause Investigation". Write 2-3 paragraphs:
   - Paragraph 1: Overall assessment. Two of four assumptions fail: location drift (t = 5.582, significant) and severe non-randomness (r1 = 0.93, runs Z = -5.3246). Only variation passes (Levene W = 0.971). Distribution and outlier tests are not meaningful given the autocorrelation. The [lag plot](/eda/techniques/lag-plot/) showed the problem immediately -- a tight linear cluster along y = x.
   - Paragraph 2: The severity of the randomness violation is extreme. The lag-1 autocorrelation of 0.93 means each measurement explains 86% of the variance of the next. The [run sequence plot](/eda/techniques/run-sequence-plot/) shows a drift and shift around observation 35. The [spectral plot](/eda/techniques/spectral-plot/) confirms low-frequency dominance without periodic peaks -- the non-randomness is drift-based, not cyclic. The standard confidence interval of 2.0019 plus/minus 0.0001 dramatically understates the true uncertainty.
   - Paragraph 3: The univariate model Y_i = C + E_i is not appropriate. The data violate independence so severely that no standard statistical inference is valid. However, the resolution is not a more complex statistical model but rather an investigation of the experimental process. The graphical and quantitative analysis successfully identified the problem; the [root cause investigation](#root-cause-investigation) below reveals that the data acquisition system was sampling too fast.

4. **Use InlineMath for all formulas** and **cross-reference links** from url-cross-reference.md.

5. **Note:** The "## Root Cause Investigation" section should remain AFTER the Interpretation section and BEFORE Conclusions. The final heading order should be: ... Quantitative Output and Interpretation ... ## Interpretation ... ## Root Cause Investigation ... ## Conclusions.
  </action>
  <verify>
Run `npx astro check 2>&1 | tail -20` to verify zero errors. Run `grep -n "^## " src/data/eda/pages/case-studies/filter-transmittance.mdx` to verify h2 heading structure: Background and Data, Test Underlying Assumptions, Graphical Output and Interpretation, Quantitative Output and Interpretation, Interpretation, Root Cause Investigation, Conclusions. Run `grep -c "r_1" src/data/eda/pages/case-studies/filter-transmittance.mdx` to verify r1 values are consistent throughout.
  </verify>
  <done>
Filter Transmittance MDX has a "## Interpretation" section between Quantitative Output and Root Cause Investigation that synthesizes the severe randomness and location violations. The r1 autocorrelation value is verified and consistent throughout the file. All test statistic values verified against NIST. `npx astro check` reports 0 errors.
  </done>
</task>

</tasks>

<verification>
1. `npx astro check` reports 0 errors
2. All 7 canonical graphical subsections present in correct order (4-Plot Overview, Run Sequence, Lag, Histogram, Normal Probability, Autocorrelation, Spectral)
3. No non-canonical heading prefixes remain ("Fixed Location --", "Randomness --")
4. h2 heading structure: Background and Data, Test Underlying Assumptions, Graphical Output and Interpretation, Quantitative Output and Interpretation, Interpretation, Root Cause Investigation, Conclusions
5. Histogram and Normal Probability Plot subsections include FilterTransmittancePlots component calls and interpretive caveats
6. Interpretation section contains InlineMath with test statistics and cross-reference links
7. r1 autocorrelation value is consistent across Summary Statistics, Randomness Tests, and Test Summary
8. `npx astro build` completes successfully (full build test)
</verification>

<success_criteria>
- Filter Transmittance has all 7 canonical graphical subsections with correct headings (FILT-01 complete)
- Filter Transmittance has full quantitative results with canonical heading and consistent r1 value (FILT-02 complete)
- Filter Transmittance has Interpretation section synthesizing severe assumption violations (FILT-03 complete)
- File builds without errors via `npx astro check` and `npx astro build`
</success_criteria>

<output>
After completion, create `.planning/phases/57-minor-gap-case-studies/57-03-SUMMARY.md`
</output>
