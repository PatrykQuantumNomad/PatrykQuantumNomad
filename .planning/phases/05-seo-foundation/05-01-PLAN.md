---
phase: 05-seo-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/SEOHead.astro
  - src/layouts/Layout.astro
  - src/pages/index.astro
  - src/pages/blog/index.astro
  - src/pages/blog/[slug].astro
  - src/pages/projects/index.astro
  - src/pages/about.astro
  - src/pages/contact.astro
  - src/pages/rss.xml.ts
  - astro.config.mjs
  - package.json
autonomous: true

must_haves:
  truths:
    - "Every page has a unique title tag (50-60 chars) and meta description (150-160 chars) in page source"
    - "Every page has a canonical URL meta tag pointing to its absolute URL on patrykgolabek.dev"
    - "Every page has Open Graph tags (og:title, og:description, og:url, og:type, og:site_name) in page source"
    - "Every page has Twitter Card meta tags (twitter:card, twitter:title, twitter:description) in page source"
    - "Visiting /sitemap-index.xml returns a valid sitemap listing all pages"
    - "Visiting /rss.xml returns a valid RSS feed with all published blog posts"
    - "robots.txt exists at site root and points to sitemap-index.xml"
  artifacts:
    - path: "src/components/SEOHead.astro"
      provides: "Reusable SEO head component with OG, Twitter, canonical tags"
      min_lines: 30
    - path: "src/pages/rss.xml.ts"
      provides: "RSS feed endpoint"
      exports: ["GET"]
    - path: "astro.config.mjs"
      provides: "Astro config with @astrojs/sitemap integration"
      contains: "sitemap"
  key_links:
    - from: "src/layouts/Layout.astro"
      to: "src/components/SEOHead.astro"
      via: "component import and render in <head>"
      pattern: "import SEOHead.*SEOHead"
    - from: "src/pages/rss.xml.ts"
      to: "astro:content"
      via: "getCollection for blog posts"
      pattern: "getCollection.*blog"
    - from: "astro.config.mjs"
      to: "@astrojs/sitemap"
      via: "integration array"
      pattern: "sitemap\\(\\)"
---

<objective>
Create the core SEO infrastructure: a reusable SEO head component with Open Graph, Twitter Card, and canonical URL tags; install @astrojs/sitemap for automatic sitemap generation; create an RSS feed endpoint; and wire SEO metadata into every page.

Purpose: Make every page on patrykgolabek.dev discoverable by search engines and social platforms with proper metadata. This is the foundation that enables Google indexing, social sharing previews, and RSS reader subscriptions.

Output: SEOHead.astro component, RSS feed at /rss.xml, sitemap at /sitemap-index.xml, all pages updated with full SEO metadata.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/layouts/Layout.astro
@src/pages/index.astro
@src/pages/blog/index.astro
@src/pages/blog/[slug].astro
@src/pages/projects/index.astro
@src/pages/about.astro
@src/pages/contact.astro
@src/content.config.ts
@astro.config.mjs
@package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install sitemap and RSS packages, create SEOHead component, create RSS feed endpoint</name>
  <files>
    package.json
    astro.config.mjs
    src/components/SEOHead.astro
    src/pages/rss.xml.ts
  </files>
  <action>
1. Install `@astrojs/sitemap` and `@astrojs/rss`:
   ```
   npm install @astrojs/sitemap @astrojs/rss
   ```

2. Update `astro.config.mjs`:
   - Import sitemap: `import sitemap from '@astrojs/sitemap';`
   - Add `sitemap()` to the integrations array AFTER tailwind (order: expressiveCode, mdx, tailwind, sitemap)

3. Create `src/components/SEOHead.astro`:
   - Props interface:
     ```typescript
     interface Props {
       title: string;
       description: string;
       canonicalURL?: URL | string;
       ogType?: 'website' | 'article';
       publishedDate?: Date;
       updatedDate?: Date;
       tags?: string[];
     }
     ```
   - Derive canonicalURL: if not provided, use `new URL(Astro.url.pathname, Astro.site)` (Astro.site comes from astro.config.mjs `site` field)
   - Render these meta tags in the component (no `<head>` wrapper — this gets slotted into Layout's `<head>`):
     ```html
     <!-- Primary Meta -->
     <title>{title}</title>
     <meta name="description" content={description} />
     <link rel="canonical" href={canonicalURL} />

     <!-- Open Graph -->
     <meta property="og:type" content={ogType} />
     <meta property="og:title" content={title} />
     <meta property="og:description" content={description} />
     <meta property="og:url" content={canonicalURL} />
     <meta property="og:site_name" content="Patryk Golabek" />
     <meta property="og:locale" content="en_CA" />

     <!-- Twitter Card -->
     <meta name="twitter:card" content="summary" />
     <meta name="twitter:title" content={title} />
     <meta name="twitter:description" content={description} />

     <!-- Article-specific (only when ogType === 'article') -->
     {ogType === 'article' && publishedDate && (
       <meta property="article:published_time" content={publishedDate.toISOString()} />
     )}
     {ogType === 'article' && updatedDate && (
       <meta property="article:modified_time" content={updatedDate.toISOString()} />
     )}
     {ogType === 'article' && tags?.map(tag => (
       <meta property="article:tag" content={tag} />
     ))}
     ```
   - Do NOT include `og:image` — that comes in Phase 7 with dynamic OG image generation
   - Do NOT include `<meta name="generator">` — that stays in Layout.astro

4. Create `src/pages/rss.xml.ts`:
   - Import `rss` from `@astrojs/rss` and `getCollection` from `astro:content`
   - Export a GET function that:
     - Fetches all non-draft blog posts via getCollection with the same draft filter pattern used elsewhere
     - Returns `rss({ title: 'Patryk Golabek | Blog', description: 'Articles on cloud-native architecture, Kubernetes, AI/ML, and platform engineering', site: context.site, items: posts.map(...) })`
     - Maps each post to: `{ title, pubDate: post.data.publishedDate, description: post.data.description, link: '/blog/' + post.id + '/' }`
  </action>
  <verify>
    Run `npm run build` — should complete without errors. Check dist/rss.xml exists and contains blog post entries. Check dist/sitemap-index.xml exists and references a sitemap file.
  </verify>
  <done>
    SEOHead component created with OG, Twitter, canonical tags. RSS feed generates at /rss.xml with blog posts. Sitemap generates at /sitemap-index.xml. Build succeeds.
  </done>
</task>

<task type="auto">
  <name>Task 2: Wire SEOHead into Layout and update all pages with unique SEO metadata</name>
  <files>
    src/layouts/Layout.astro
    src/pages/index.astro
    src/pages/blog/index.astro
    src/pages/blog/[slug].astro
    src/pages/projects/index.astro
    src/pages/about.astro
    src/pages/contact.astro
  </files>
  <action>
1. Update `src/layouts/Layout.astro`:
   - Import SEOHead: `import SEOHead from '../components/SEOHead.astro';`
   - Expand Props interface to match SEOHead props:
     ```typescript
     interface Props {
       title: string;
       description: string;
       canonicalURL?: URL | string;
       ogType?: 'website' | 'article';
       publishedDate?: Date;
       updatedDate?: Date;
       tags?: string[];
     }
     ```
   - Destructure all props with defaults: `ogType = 'website'`
   - In `<head>`, REMOVE the existing `<title>{title}</title>` and `<meta name="description">` tags (SEOHead handles these now)
   - Add `<SEOHead title={title} description={description} canonicalURL={canonicalURL} ogType={ogType} publishedDate={publishedDate} updatedDate={updatedDate} tags={tags} />` in the `<head>` section, after the `<meta name="generator">` tag
   - Keep all existing head content (charset, viewport, generator, FOUC script, Google Fonts)
   - Add RSS autodiscovery link in `<head>`: `<link rel="alternate" type="application/rss+xml" title="Patryk Golabek | Blog" href="/rss.xml" />`

2. Update each page's Layout component usage with unique, SEO-optimized metadata. Every title should be 50-60 chars and every description 150-160 chars:

   **src/pages/index.astro** (homepage):
   - title: `"Patryk Golabek — Cloud-Native Architect & AI/ML Engineer"` (55 chars)
   - description: `"Portfolio of Patryk Golabek, Cloud-Native Software Architect with 17+ years in Kubernetes, AI/ML systems, platform engineering, and DevSecOps."` (143 chars)
   - ogType: `"website"` (default)

   **src/pages/blog/index.astro** (blog listing):
   - title: `"Blog — Patryk Golabek | Cloud-Native & AI/ML Articles"` (55 chars)
   - description: `"Technical articles on Kubernetes, cloud-native architecture, AI/ML engineering, LLM agents, RAG pipelines, and platform engineering by Patryk Golabek."` (152 chars)

   **src/pages/blog/[slug].astro** (individual blog posts):
   - title: Use `{title} — Patryk Golabek` (title from post frontmatter)
   - description: Use `{description}` from post frontmatter (authors should write 150-160 char descriptions)
   - ogType: `"article"`
   - publishedDate: `{publishedDate}` from post frontmatter
   - updatedDate: `{post.data.updatedDate}` if present
   - tags: `{tags}` from post frontmatter

   **src/pages/projects/index.astro**:
   - title: `"Projects — Patryk Golabek | Open-Source Portfolio"` (50 chars)
   - description: `"Explore 19 open-source projects by Patryk Golabek spanning Kubernetes platforms, AI/ML agents, infrastructure as code, and full-stack applications."` (149 chars)

   **src/pages/about.astro**:
   - title: `"About — Patryk Golabek | Cloud-Native Software Architect"` (57 chars)
   - description: `"About Patryk Golabek — 17+ years building cloud-native systems, Kubernetes platforms, AI/ML pipelines, and developer tools. Based in Ontario, Canada."` (150 chars)

   **src/pages/contact.astro**:
   - title: `"Contact — Patryk Golabek | Cloud-Native Architect"` (50 chars)
   - description: `"Get in touch with Patryk Golabek for cloud-native architecture, Kubernetes, AI/ML engineering, and platform engineering opportunities and collaboration."` (153 chars)
  </action>
  <verify>
    Run `npm run build`. Then inspect the built HTML files for correct meta tags:
    - `grep -r 'og:title' dist/` should show unique OG titles for each page
    - `grep -r 'canonical' dist/` should show canonical URLs for each page
    - `grep -r 'twitter:card' dist/` should show twitter card tags on each page
    - `grep -r 'article:published_time' dist/` should appear only in blog post pages
  </verify>
  <done>
    All 7 pages have unique title (50-60 chars), meta description (150-160 chars), canonical URL, Open Graph tags, and Twitter Card tags. Blog posts additionally have article:published_time, article:modified_time, and article:tag OG metadata. RSS autodiscovery link present in head.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. Every HTML file in dist/ contains: `<title>`, `<meta name="description">`, `<link rel="canonical">`, `<meta property="og:title">`, `<meta property="og:description">`, `<meta property="og:url">`, `<meta name="twitter:card">`
3. dist/rss.xml exists and is valid XML with blog post items
4. dist/sitemap-index.xml exists and references a child sitemap with page URLs
5. dist/blog/building-kubernetes-observability-stack/index.html contains `article:published_time` OG tag
6. No duplicate `<title>` or `<meta name="description">` tags in any page (SEOHead replaced the old ones)
</verification>

<success_criteria>
- All 7 pages have unique title tags (50-60 chars) and meta descriptions (150-160 chars)
- All pages have canonical URL, Open Graph, and Twitter Card meta tags
- /sitemap-index.xml generates with all page URLs
- /rss.xml generates with all published blog posts
- robots.txt points to sitemap-index.xml (already exists from Phase 1)
- Build succeeds with zero errors
</success_criteria>

<output>
After completion, create `.planning/phases/05-seo-foundation/05-01-SUMMARY.md`
</output>
