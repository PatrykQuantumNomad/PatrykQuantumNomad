---
phase: 47-seo-documentation-site-integration
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/lib/og-image.ts
  - src/pages/open-graph/tools/k8s-analyzer.png.ts
  - src/components/K8sAnalyzerJsonLd.astro
  - src/pages/tools/k8s-analyzer/index.astro
autonomous: true

must_haves:
  truths:
    - "OG image at /open-graph/tools/k8s-analyzer.png renders a two-column layout with K8s YAML code panel"
    - "Tool page includes SoftwareApplication JSON-LD structured data"
    - "Tool page aside links to rule documentation and companion blog post"
    - "Tool page has correct ogImage meta for social sharing"
  artifacts:
    - path: "src/lib/og-image.ts"
      provides: "generateK8sAnalyzerOgImage function"
      exports: ["generateK8sAnalyzerOgImage"]
    - path: "src/pages/open-graph/tools/k8s-analyzer.png.ts"
      provides: "OG image API route"
      exports: ["GET"]
    - path: "src/components/K8sAnalyzerJsonLd.astro"
      provides: "SoftwareApplication JSON-LD component"
      contains: "SoftwareApplication"
    - path: "src/pages/tools/k8s-analyzer/index.astro"
      provides: "Updated tool page with JSON-LD, OG image, aside links"
      contains: "K8sAnalyzerJsonLd"
  key_links:
    - from: "src/pages/open-graph/tools/k8s-analyzer.png.ts"
      to: "src/lib/og-image.ts"
      via: "import generateK8sAnalyzerOgImage"
      pattern: "generateK8sAnalyzerOgImage"
    - from: "src/pages/tools/k8s-analyzer/index.astro"
      to: "src/components/K8sAnalyzerJsonLd.astro"
      via: "import K8sAnalyzerJsonLd"
      pattern: "K8sAnalyzerJsonLd"
---

<objective>
Create the OG image generator, JSON-LD structured data component, OG image API route, and update the tool page with all SEO enhancements.

Purpose: The tool page needs SoftwareApplication JSON-LD for search engines, an OG image for social sharing, and updated aside content linking to rule docs and the blog post.
Output: Fully SEO-optimized tool page with OG image and structured data.
</objective>

<execution_context>
@/Users/patrykattc/.claude/get-shit-done/workflows/execute-plan.md
@/Users/patrykattc/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/lib/og-image.ts
@src/pages/open-graph/tools/compose-validator.png.ts
@src/components/ComposeValidatorJsonLd.astro
@src/pages/tools/k8s-analyzer/index.astro
@src/layouts/Layout.astro
@src/components/SEOHead.astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create OG image generator + API route</name>
  <files>
    src/lib/og-image.ts
    src/pages/open-graph/tools/k8s-analyzer.png.ts
  </files>
  <action>
**og-image.ts -- add `generateK8sAnalyzerOgImage()`:**
Follow the exact pattern of `generateComposeValidatorOgImage()`. Two-column layout: text left (title, description, category pills), dark YAML code panel right.

Differences from Compose Validator version:
- Title: `'Kubernetes Manifest Analyzer'`
- Description: `'Free browser-based Kubernetes manifest linter with 67 rules across schema, security, reliability, best-practice, and cross-resource categories.'`
- Categories: `['Schema', 'Security', 'Reliability', 'Best Practice', 'Cross-Resource']`
- Code lines (stylized K8s YAML):
  ```
  { keyword: 'apiVersion:', rest: 'apps/v1', marker: null },
  { keyword: 'kind:', rest: 'Deployment', marker: null },
  { keyword: '  replicas:', rest: '1', marker: 'warning' },
  { keyword: '  privileged:', rest: 'true', marker: 'error' },
  { keyword: '  image:', rest: 'app:latest', marker: 'warning' },
  ```
- Rule count badge: `'67'` (not `'52'`)

Everything else (layout, colors, spacing, accentBar(), brandingRow(), renderOgPng) stays identical.

**k8s-analyzer.png.ts (new file):**
Follow the exact pattern of `compose-validator.png.ts`:
```typescript
import type { APIRoute } from 'astro';
import { generateK8sAnalyzerOgImage } from '../../../lib/og-image';

export const GET: APIRoute = async () => {
  const png = await generateK8sAnalyzerOgImage();
  return new Response(png, {
    headers: {
      'Content-Type': 'image/png',
      'Cache-Control': 'public, max-age=31536000, immutable',
    },
  });
};
```
  </action>
  <verify>
Run `npx tsc --noEmit` -- no type errors. Run `npx astro build 2>&1 | head -30` to verify the OG image route compiles (full build not needed, just compilation).
  </verify>
  <done>generateK8sAnalyzerOgImage function exists in og-image.ts; OG image API route exists at /open-graph/tools/k8s-analyzer.png.</done>
</task>

<task type="auto">
  <name>Task 2: Create JSON-LD component + update tool page</name>
  <files>
    src/components/K8sAnalyzerJsonLd.astro
    src/pages/tools/k8s-analyzer/index.astro
  </files>
  <action>
**K8sAnalyzerJsonLd.astro (new file):**
Follow the exact pattern of `ComposeValidatorJsonLd.astro`. Use the JSON-LD schema from the research file (47-RESEARCH.md, Pattern 4). Key fields:
- name: "Kubernetes Manifest Analyzer"
- description: Full description from research
- url: "https://patrykgolabek.dev/tools/k8s-analyzer/"
- screenshot: "https://patrykgolabek.dev/open-graph/tools/k8s-analyzer.png"
- softwareHelp url: "https://patrykgolabek.dev/blog/kubernetes-manifest-best-practices/"
- keywords: From research (kubernetes manifest analyzer, kubernetes linter, etc.)
- featureList: From research (67 validation rules, PSS compliance, etc.)
- Same author, isPartOf, offers structure

**index.astro updates:**
1. Add import for `K8sAnalyzerJsonLd` and add `<K8sAnalyzerJsonLd />` inside the Layout (after BreadcrumbJsonLd)
2. Add `ogImage="/open-graph/tools/k8s-analyzer.png"` and `ogImageAlt="Kubernetes Manifest Analyzer - 67 rules across schema, security, reliability, best-practice, and cross-resource categories"` props to the Layout component
3. Update the aside section to replace the "coming soon" text with links:
   - Link to rule documentation: "Explore all 67 rules" linking to `/tools/k8s-analyzer/rules/ka-s001/` (first rule)
   - Link to companion blog post: "Read the best practices guide" linking to `/blog/kubernetes-manifest-best-practices/`
   - A note about 100% client-side analysis
4. Keep the existing BreadcrumbJsonLd component
  </action>
  <verify>
Run `npx tsc --noEmit` -- no type errors. Verify K8sAnalyzerJsonLd.astro renders a `<script type="application/ld+json">` tag with SoftwareApplication type.
  </verify>
  <done>Tool page includes SoftwareApplication JSON-LD, OG image meta, and updated aside with rule docs + blog links.</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with no errors
2. K8sAnalyzerJsonLd.astro exists with correct SoftwareApplication schema
3. OG image route exists at src/pages/open-graph/tools/k8s-analyzer.png.ts
4. Tool page index.astro imports and renders K8sAnalyzerJsonLd
5. Tool page has ogImage prop on Layout component
</verification>

<success_criteria>
The tool page has complete SEO metadata: SoftwareApplication JSON-LD, BreadcrumbJsonLd, OG image for social sharing, and updated content aside with links to rule documentation and blog post.
</success_criteria>

<output>
After completion, create `.planning/phases/47-seo-documentation-site-integration/47-02-SUMMARY.md`
</output>
