---
phase: 60-beam-deflections-deep-dive
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/eda/BeamDeflectionPlots.astro
  - src/data/eda/pages/case-studies/beam-deflections.mdx
autonomous: true
requirements: [BEAM-01, BEAM-04]

must_haves:
  truths:
    - "BeamDeflectionPlots.astro supports a 'residual-spectral' plot type that renders a spectral plot of sinusoidal model residuals"
    - "Every residual plot subsection in the Validate New Model section has at least one interpretation paragraph below the plot component"
    - "A new Residual Spectral Plot subsection exists in the MDX with both a plot component and interpretation text"
  artifacts:
    - path: "src/components/eda/BeamDeflectionPlots.astro"
      provides: "residual-spectral plot type rendering"
      contains: "residual-spectral"
    - path: "src/data/eda/pages/case-studies/beam-deflections.mdx"
      provides: "Per-plot interpretation text for all 7 residual subsections"
      contains: "Residual Spectral Plot"
  key_links:
    - from: "src/data/eda/pages/case-studies/beam-deflections.mdx"
      to: "src/components/eda/BeamDeflectionPlots.astro"
      via: "BeamDeflectionPlots type='residual-spectral'"
      pattern: "type=\"residual-spectral\""
---

<objective>
Add the residual-spectral plot type to BeamDeflectionPlots.astro and write per-plot interpretation text for all 7 residual plot subsections in the beam-deflections.mdx case study.

Purpose: BEAM-01 requires per-plot interpretation for residual plots (5 of 6 currently lack text), and BEAM-04 requires a residual spectral plot (currently missing from both the component and the MDX). This plan delivers the infrastructure change and all residual interpretation content.

Output: Updated BeamDeflectionPlots.astro with residual-spectral support; updated beam-deflections.mdx with interpretation paragraphs for all 7 residual subsections (4-plot, run sequence, lag, histogram, probability, autocorrelation, spectral).
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/60-beam-deflections-deep-dive/60-RESEARCH.md

@src/components/eda/BeamDeflectionPlots.astro
@src/data/eda/pages/case-studies/beam-deflections.mdx
@src/data/eda/pages/case-studies/random-walk.mdx (reference pattern for residual interpretation)
@src/lib/eda/svg-generators/index.ts (generateSpectralPlot import)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add residual-spectral plot type to BeamDeflectionPlots.astro</name>
  <files>src/components/eda/BeamDeflectionPlots.astro</files>
  <action>
Make three changes to BeamDeflectionPlots.astro:

1. **Update the PlotType union** (line 20-25): Add `'residual-spectral'` to the union type, after `'residual-autocorrelation'`:
   ```typescript
   type PlotType =
     | '4-plot' | 'run-sequence' | 'lag' | 'histogram' | 'probability'
     | 'autocorrelation' | 'spectral'
     | 'residual-4-plot'
     | 'residual-run-sequence' | 'residual-lag' | 'residual-histogram'
     | 'residual-probability' | 'residual-autocorrelation'
     | 'residual-spectral';
   ```

2. **Add the switch case** after the `residual-autocorrelation` case (after the existing break around line 186):
   ```typescript
   case 'residual-spectral':
     svg = generateSpectralPlot({
       data: residuals,
       config: singleConfig,
       title: 'Residual Spectral Plot',
     });
     break;
   ```

3. **Add the default caption** in the `defaultCaptions` record (after the `residual-autocorrelation` entry):
   ```typescript
   'residual-spectral': 'Spectral plot of sinusoidal model residuals -- a flat spectrum with no dominant peaks confirms the periodic structure has been successfully removed.',
   ```

Important: `generateSpectralPlot` is already imported on line 18. No new imports needed.
  </action>
  <verify>
    <automated>cd /Users/patrykattc/work/git/PatrykQuantumNomad && npx astro check 2>&1 | tail -20</automated>
  </verify>
  <done>BeamDeflectionPlots.astro has 'residual-spectral' in the PlotType union, a switch case that calls generateSpectralPlot with residuals data, and a default caption. TypeScript compiles with zero errors.</done>
</task>

<task type="auto">
  <name>Task 2: Write per-plot interpretation for all 7 residual subsections</name>
  <files>src/data/eda/pages/case-studies/beam-deflections.mdx</files>
  <action>
Update 6 existing residual subsections and add 1 new subsection in beam-deflections.mdx. Follow the Random Walk case study pattern: 1-3 sentences per residual subsection interpreting what the plot shows and which assumption it addresses.

**1. Update "### 4-Plot of Residuals"** (around line 212-224): Replace the existing bullet list ("The transformation compared to the original data's 4-plot should show:...") with definitive interpretation. Remove the "should show" language and state what the plots actually show:

Replace the content after the `<BeamDeflectionPlots type="residual-4-plot" />` component (lines 217-223, the bullet list block) with:

```
The transformation compared to the original data's 4-plot is dramatic:

- **Run sequence plot** (upper left) -- the oscillatory pattern is gone; residuals fluctuate randomly around zero with no systematic structure
- **Lag plot** (upper right) -- the elliptical dependence structure is replaced by a random, structureless cloud
- **Histogram** (lower left) -- approximately symmetric and bell-shaped, consistent with normality
- **Normal probability plot** (lower right) -- approximately linear with minor curvature in the left tail, suggesting the residuals are close to but not perfectly normal
```

**2. Update "### Residual Run Sequence Plot"** (around line 226): Add interpretation paragraph after the `<BeamDeflectionPlots type="residual-run-sequence" />` component:

```
The residuals fluctuate randomly around zero with no oscillatory pattern, no trend, and no visible shifts in variability -- the **fixed-location and fixed-variation assumptions are satisfied**.
```

**3. Update "### Residual Lag Plot"** (around line 230): Add interpretation paragraph after the `<BeamDeflectionPlots type="residual-lag" />` component:

```
The residual lag plot shows a random, structureless cloud replacing the tight elliptical pattern of the original data -- the **randomness assumption is satisfied**. The sinusoidal model has successfully removed the periodic dependence.
```

**4. Update "### Residual Histogram"** (around line 234): Add interpretation paragraph after the `<BeamDeflectionPlots type="residual-histogram" />` component:

```
The residual histogram is approximately symmetric and bell-shaped, centered near zero. The shape is consistent with a normal distribution, though a slight leftward tail asymmetry is visible.
```

**5. Update "### Residual Normal Probability Plot"** (around line 238): Add interpretation paragraph after the `<BeamDeflectionPlots type="residual-probability" />` component:

```
The normal probability plot of residuals is approximately linear through the central portion. A bend in the left tail suggests some departure from normality -- NIST notes this as "some cause for concern" but concludes the fit is "reasonably good." The **distribution is approximately normal**.
```

**6. Update "### Residual Autocorrelation Plot"** (around line 242-244): Keep the existing component but replace the existing single sentence ("The residual autocorrelation plot should show...") with definitive interpretation:

```
The residual autocorrelation is dramatically reduced compared to the original data. Most lags fall within the 95% confidence bands of <InlineMath tex="\pm 0.1414" />, confirming that the sinusoidal model has successfully removed the periodic dependence structure. The **randomness assumption is satisfied**.
```

**7. Add new "### Residual Spectral Plot" subsection** after the Residual Autocorrelation Plot subsection and before `## Conclusions`:

```
### Residual Spectral Plot

<BeamDeflectionPlots type="residual-spectral" />

The residual spectral plot shows a relatively flat spectrum with no dominant peaks. The prominent peak near frequency 0.3 in the original data's [spectral plot](/eda/techniques/spectral-plot/) has been eliminated, confirming that the sinusoidal model has captured the periodic component.
```

Important notes:
- Use `<InlineMath tex="..." />` for all mathematical values (already imported at line 9).
- Cross-reference links must use URLs from the url-cross-reference.md cheat sheet.
- Every subsection must have BOTH a plot component AND interpretation text. No subsection should have only the component tag.
  </action>
  <verify>
    <automated>cd /Users/patrykattc/work/git/PatrykQuantumNomad && npx astro check 2>&1 | tail -20 && npx astro build 2>&1 | tail -20</automated>
  </verify>
  <done>All 7 residual subsections (4-plot, run sequence, lag, histogram, probability, autocorrelation, spectral) have both a BeamDeflectionPlots component and at least one interpretation paragraph. The site builds successfully with zero errors.</done>
</task>

</tasks>

<verification>
1. `npx astro check` reports 0 errors -- TypeScript types are correct
2. `npx astro build` succeeds -- the residual spectral plot renders at build time without errors
3. Every `### Residual` subsection in beam-deflections.mdx has both a `<BeamDeflectionPlots>` component and at least one paragraph of interpretation text below it
4. The BeamDeflectionPlots.astro PlotType union includes 'residual-spectral'
</verification>

<success_criteria>
- BeamDeflectionPlots.astro supports 'residual-spectral' as a valid PlotType with switch case and default caption
- All 7 residual subsections have per-plot interpretation paragraphs (not "should show" language)
- New Residual Spectral Plot subsection exists with component and interpretation
- Site builds successfully with npx astro build
</success_criteria>

<output>
After completion, create `.planning/phases/60-beam-deflections-deep-dive/60-01-SUMMARY.md`
</output>
