---
phase: 30-overview-page
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/lib/db-compass/use-case-categories.ts
  - src/stores/compassFilterStore.ts
  - src/components/db-compass/ModelCardGrid.astro
  - src/components/db-compass/DimensionLegend.astro
  - src/components/db-compass/CompassJsonLd.astro
autonomous: true
requirements: [PAGE-01, SEO-01, SEO-03]

must_haves:
  truths:
    - "Use-case categories map all 58 raw use cases into 10 groups with zero unmapped strings"
    - "Filter store exposes active categories as a nanostores atom with init/toggle/selectAll/selectNone"
    - "Model card grid renders 12 clickable model cards with radar chart thumbnails and data-model-id attributes"
    - "Dimension legend displays all 8 dimensions with symbol, name, and description"
    - "CompassJsonLd outputs valid JSON-LD Dataset + ItemList with 12 ListItem entries"
  artifacts:
    - path: "src/lib/db-compass/use-case-categories.ts"
      provides: "USE_CASE_CATEGORIES array and modelCategories helper"
      exports: ["USE_CASE_CATEGORIES", "UseCaseCategory", "modelCategories"]
    - path: "src/stores/compassFilterStore.ts"
      provides: "Nanostores atom for active use-case filter categories"
      exports: ["activeCategories", "initCategories", "toggleCategory", "selectAllCategories", "selectNoCategories"]
    - path: "src/components/db-compass/ModelCardGrid.astro"
      provides: "Grid of 12 model cards with radar thumbnails and filter data attributes"
      contains: "data-model-id"
    - path: "src/components/db-compass/DimensionLegend.astro"
      provides: "8-dimension reference section with symbols and descriptions"
      contains: "DIMENSIONS"
    - path: "src/components/db-compass/CompassJsonLd.astro"
      provides: "Dataset + ItemList JSON-LD for SEO"
      contains: "application/ld+json"
  key_links:
    - from: "src/lib/db-compass/use-case-categories.ts"
      to: "src/data/db-compass/models.json"
      via: "USE_CASE_CATEGORIES.useCases covers all raw model useCases"
      pattern: "useCases"
    - from: "src/stores/compassFilterStore.ts"
      to: "src/lib/db-compass/use-case-categories.ts"
      via: "atom tracks category IDs from USE_CASE_CATEGORIES"
      pattern: "import.*use-case-categories"
    - from: "src/components/db-compass/ModelCardGrid.astro"
      to: "src/components/db-compass/CompassRadarChart.astro"
      via: "renders radar thumbnail per model card"
      pattern: "CompassRadarChart"
---

<objective>
Create the foundation utilities and reusable sub-components needed by the Database Compass overview page: use-case category mapping, nanostores filter state, model card grid, dimension legend, and JSON-LD structured data component.

Purpose: These are the building blocks that Plan 02 will compose into the full overview page. Splitting them out keeps each plan focused and under context budget.
Output: 5 new files -- 2 utilities, 3 Astro components -- all ready for page assembly.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/30-overview-page/30-RESEARCH.md
@.planning/phases/29-visualization-components/29-01-SUMMARY.md
@.planning/phases/29-visualization-components/29-02-SUMMARY.md

@src/lib/db-compass/schema.ts
@src/lib/db-compass/dimensions.ts
@src/data/db-compass/models.json
@src/stores/languageFilterStore.ts
@src/components/BeautyIndexJsonLd.astro
@src/components/BreadcrumbJsonLd.astro
@src/components/beauty-index/LanguageGrid.astro
@src/components/db-compass/CompassRadarChart.astro
@src/components/db-compass/CapBadge.astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create use-case category mapping and filter store</name>
  <files>
    src/lib/db-compass/use-case-categories.ts
    src/stores/compassFilterStore.ts
  </files>
  <action>
    **use-case-categories.ts:**
    Create the use-case category mapping that groups the 58 raw use-case strings from models.json into 10 high-level filter categories. Follow the exact mapping from the RESEARCH.md code example:
    - Export `UseCaseCategory` interface with `id: string`, `label: string`, `useCases: string[]`
    - Export `USE_CASE_CATEGORIES` array with 10 categories: caching, analytics, oltp, search, iot, ai-ml, content, graph, realtime, infra
    - Export `modelCategories(modelUseCases: string[]): string[]` helper that returns which category IDs a model belongs to based on its useCases array matching against USE_CASE_CATEGORIES
    - IMPORTANT: Every use-case string from all 12 models in models.json must map to at least one category. Read models.json first and verify coverage.

    **compassFilterStore.ts:**
    Create a nanostores atom following the exact pattern from `src/stores/languageFilterStore.ts`:
    - Export `activeCategories` atom of type `atom<Set<string>>`
    - Export `initCategories(ids: string[])` -- sets all category IDs as active
    - Export `toggleCategory(id: string)` -- toggles a single category
    - Export `selectAllCategories(ids: string[])` -- selects all categories
    - Export `selectNoCategories()` -- clears selection
    - Import naming follows the existing store naming convention (camelCase exports, atom from nanostores)
  </action>
  <verify>
    Run `npx astro check 2>&1 | grep -E 'use-case-categories|compassFilter'` -- should show no type errors.
    Verify manually that all 58 unique use-case strings from models.json appear in at least one category by reading both files.
  </verify>
  <done>
    use-case-categories.ts exports USE_CASE_CATEGORIES (10 categories covering all 58 raw use cases) and modelCategories helper. compassFilterStore.ts exports nanostores atom with init/toggle/selectAll/selectNone matching languageFilterStore.ts pattern.
  </done>
</task>

<task type="auto">
  <name>Task 2: Build ModelCardGrid, DimensionLegend, and CompassJsonLd components</name>
  <files>
    src/components/db-compass/ModelCardGrid.astro
    src/components/db-compass/DimensionLegend.astro
    src/components/db-compass/CompassJsonLd.astro
  </files>
  <action>
    **ModelCardGrid.astro:**
    Follow the LanguageGrid.astro pattern -- a grid of clickable model cards with radar chart thumbnails:
    - Accept `models: DbModel[]` prop (import DbModel from schema.ts)
    - Render a responsive grid: `grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4`
    - Each card is an `<a>` linking to `/tools/db-compass/${model.slug}/`
    - Each card includes:
      - `data-model-id={model.id}` attribute (critical for filter integration)
      - `data-use-cases={model.useCases.join(',')}` attribute (for filter matching)
      - `<CompassRadarChart model={model} size={160} />` thumbnail
      - Model name as `text-sm font-medium`
      - Total score as `text-xs text-[var(--color-text-secondary)]` showing `{totalScore(model)}/80`
      - `<CapBadge classification={model.capTheorem.classification} size="sm" />`
    - Card styling: `rounded-xl border border-[var(--color-border)] hover:border-[var(--color-accent)] transition-colors bg-[var(--color-surface)] p-3 flex flex-col items-center`
    - Import totalScore from schema.ts, CompassRadarChart and CapBadge from db-compass components

    **DimensionLegend.astro:**
    Display all 8 dimensions in a reference grid:
    - Import DIMENSIONS from dimensions.ts and DIMENSION_COLORS from dimensions.ts
    - Render a `grid grid-cols-1 sm:grid-cols-2 gap-4` layout
    - Each dimension shows: colored symbol (using DIMENSION_COLORS[dim.key]) with `aria-hidden="true"`, dimension name in bold, and description text
    - The symbol should be rendered in a small colored circle or with a colored background
    - Add appropriate heading and intro text explaining the 8 scoring dimensions

    **CompassJsonLd.astro:**
    Follow the BeautyIndexJsonLd.astro pattern exactly:
    - Accept `models: DbModel[]` prop (sorted by totalScore descending)
    - Import DIMENSIONS from dimensions.ts, totalScore from schema.ts
    - Build schema object with:
      - `@type: "Dataset"` with name "Database Compass", description covering 12 models and 8 dimensions
      - `url: "https://patrykgolabek.dev/tools/db-compass/"`
      - `datePublished: "2026-02-22"` and `dateModified: "2026-02-22"`
      - `creator` with `@type: "Person"` and `@id: "https://patrykgolabek.dev/#person"`
      - `keywords` array with database-related SEO terms
      - `variableMeasured: DIMENSIONS.map((dim) => dim.name)`
      - `mainEntity` as ItemList with each model as a ListItem (position, name with score, url to detail page)
    - Render as `<script type="application/ld+json" set:html={JSON.stringify(schema)} />`
    - Use the exact JSON-LD structure from RESEARCH.md code example
  </action>
  <verify>
    Run `npx astro check 2>&1 | grep -E 'ModelCardGrid|DimensionLegend|CompassJsonLd'` -- zero type errors.
    Run `npx astro build 2>&1 | tail -5` -- build succeeds (components exist but are not yet composed into a page, so no route-level test yet).
  </verify>
  <done>
    ModelCardGrid renders 12 cards with radar thumbnails and data-model-id/data-use-cases attributes for filter integration. DimensionLegend shows all 8 dimensions with colored symbols and descriptions. CompassJsonLd outputs valid Dataset + ItemList JSON-LD matching the BeautyIndexJsonLd pattern.
  </done>
</task>

</tasks>

<verification>
1. `npx astro check` passes with zero errors in the 5 new files
2. `npx astro build` succeeds (components created but not yet on a page route)
3. use-case-categories.ts covers all 58 raw use-case strings from models.json
4. compassFilterStore.ts follows the exact nanostores pattern from languageFilterStore.ts
5. ModelCardGrid has `data-model-id` and `data-use-cases` attributes on every card
6. CompassJsonLd contains proper Dataset + ItemList schema with 12 ListItem entries
</verification>

<success_criteria>
- All 5 files exist and pass TypeScript type checking
- Use-case categories cover every raw use-case string from all 12 models
- Model card grid renders with data attributes ready for filter integration
- JSON-LD follows BeautyIndexJsonLd pattern with Database Compass data
- Build succeeds cleanly
</success_criteria>

<output>
After completion, create `.planning/phases/30-overview-page/30-01-SUMMARY.md`
</output>
