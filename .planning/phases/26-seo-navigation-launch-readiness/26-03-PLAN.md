---
phase: 26-seo-navigation-launch-readiness
plan: 03
type: execute
wave: 2
depends_on: [26-01, 26-02]
files_modified:
  - src/components/tools/results/ScoreGauge.tsx
autonomous: false
requirements: [SEO-05, SEO-06]

must_haves:
  truths:
    - "Lighthouse Performance score is 90+ on the tool page"
    - "Lighthouse Accessibility score is 90+ on the tool page"
    - "Lighthouse Best Practices score is 90+ on the tool page"
    - "Lighthouse SEO score is 90+ on the tool page"
    - "ScoreGauge overlay div has role='status' for valid ARIA"
    - "Keyboard navigation works through all interactive elements on the tool page"
  artifacts:
    - path: "src/components/tools/results/ScoreGauge.tsx"
      provides: "Accessible score gauge with role=status on overlay div"
      contains: "role"
  key_links: []
---

<objective>
Run Lighthouse audits on the Dockerfile Analyzer tool page, fix the ScoreGauge accessibility issue, and verify keyboard navigation and screen reader accessibility across the tool and rule pages.

Purpose: Final quality gate ensuring the Dockerfile Analyzer meets production-ready performance, accessibility, SEO, and best practices standards. This mirrors Phase 21 Plan 03 (Lighthouse audit for Beauty Index).
Output: Lighthouse audit results with all scores 90+. ScoreGauge ARIA fix applied. Accessibility verified.
</objective>

<execution_context>
@/Users/patrykattc/.claude/get-shit-done/workflows/execute-plan.md
@/Users/patrykattc/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/26-seo-navigation-launch-readiness/26-RESEARCH.md
@.planning/phases/26-seo-navigation-launch-readiness/26-01-SUMMARY.md
@.planning/phases/26-seo-navigation-launch-readiness/26-02-SUMMARY.md
@src/components/tools/results/ScoreGauge.tsx
@src/components/tools/DockerfileAnalyzer.tsx
@src/components/tools/EditorPanel.tsx
@src/components/tools/ResultsPanel.tsx
@src/components/tools/results/ViolationList.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix ScoreGauge accessibility, run Lighthouse audits, and verify accessibility</name>
  <files>src/components/tools/results/ScoreGauge.tsx</files>
  <action>
  **Step 1: Fix ScoreGauge ARIA issue**

  In `src/components/tools/results/ScoreGauge.tsx`, update the overlay `<div>` (currently lines 54-57) to add `role="status"` and enhance the `aria-label`:

  Current:
  ```tsx
  <div
    className="absolute inset-0 flex flex-col items-center justify-center"
    aria-label={`Score ${score}, Grade ${grade}`}
  >
  ```

  Updated:
  ```tsx
  <div
    className="absolute inset-0 flex flex-col items-center justify-center"
    role="status"
    aria-label={`Dockerfile analysis score: ${score} out of 100, grade ${grade}`}
  >
  ```

  The `role="status"` makes the `aria-label` valid on this non-interactive element (ARIA spec requires a role for `aria-label` on `<div>` elements). It also implies `aria-live="polite"`, so screen readers announce score changes when the user clicks Analyze. This is desirable since the score only changes on explicit user action.

  **Step 2: Build and run Lighthouse**

  ```bash
  npx astro build
  npx astro preview &
  sleep 3

  # Audit tool page
  npx lighthouse http://localhost:4321/tools/dockerfile-analyzer/ \
    --output=json --output-path=./lighthouse-tool.json \
    --chrome-flags="--headless --no-sandbox" --quiet

  # Audit a representative rule page
  npx lighthouse http://localhost:4321/tools/dockerfile-analyzer/rules/dl3006/ \
    --output=json --output-path=./lighthouse-rule.json \
    --chrome-flags="--headless --no-sandbox" --quiet

  # Extract scores
  node -e "const r=require('./lighthouse-tool.json'); const c=r.categories; console.log('Tool Page:', 'Perf:', Math.round(c.performance.score*100), 'A11y:', Math.round(c.accessibility.score*100), 'BP:', Math.round(c['best-practices'].score*100), 'SEO:', Math.round(c.seo.score*100))"

  node -e "const r=require('./lighthouse-rule.json'); const c=r.categories; console.log('Rule Page:', 'Perf:', Math.round(c.performance.score*100), 'A11y:', Math.round(c.accessibility.score*100), 'BP:', Math.round(c['best-practices'].score*100), 'SEO:', Math.round(c.seo.score*100))"

  kill %1
  ```

  Target: All 4 categories at 90+ on both pages.

  If `lighthouse` is not available globally, install it: `npm install -g lighthouse`

  **Step 3: If any score is below 90, diagnose and fix**

  List failing audits:
  ```bash
  node -e "const r=require('./lighthouse-tool.json'); r.audits && Object.values(r.audits).filter(a => a.score !== null && a.score < 1).forEach(a => console.log(a.id, Math.round(a.score*100), a.title))"
  ```

  Common fixes based on research:
  - **Performance < 90**: Check if LCP element is the CodeMirror container (it should be the h1/description). If so, ensure server-rendered content above the React island is substantial.
  - **Accessibility < 90**: Check for missing aria-labels, color contrast issues, or form label problems. The ScoreGauge fix above should resolve the most likely issue.
  - **SEO < 90**: Verify meta description, canonical URL, and structured data are present (these should all be handled by Plan 01).
  - **Best Practices < 90**: Check for CSP violations, deprecated APIs, or console errors.

  After any fixes, rebuild and re-run Lighthouse.

  **Step 4: Verify accessibility elements in built HTML**

  ```bash
  # Verify tool page breadcrumbs
  grep -c 'aria-label="Breadcrumb"' dist/tools/dockerfile-analyzer/index.html

  # Verify SoftwareApplication JSON-LD
  grep -c 'SoftwareApplication' dist/tools/dockerfile-analyzer/index.html

  # Verify BreadcrumbList JSON-LD
  grep -c 'BreadcrumbList' dist/tools/dockerfile-analyzer/index.html

  # Verify rule page breadcrumbs (sample)
  grep -c 'aria-label="Breadcrumb"' dist/tools/dockerfile-analyzer/rules/dl3006/index.html

  # Verify /tools/ redirect
  grep -i "redirect\|location" dist/tools/index.html 2>/dev/null || echo "Check redirect mechanism"
  ```

  **Step 5: Clean up**

  Delete Lighthouse JSON files (do not commit them):
  ```bash
  rm -f lighthouse-tool.json lighthouse-rule.json
  ```
  </action>
  <verify>Lighthouse JSON output files generated and scores extracted. All 4 categories at 90+ on tool page. ScoreGauge.tsx has `role="status"` on the overlay div. Accessibility elements confirmed in built HTML.</verify>
  <done>All Lighthouse scores at 90+ on tool page and rule page. ScoreGauge has valid ARIA with role="status". Breadcrumbs, JSON-LD, and meta descriptions confirmed in generated HTML.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: User verification of complete Phase 26 integration</name>
  <what-built>
  Complete SEO, navigation, and accessibility integration for the Dockerfile Analyzer:
  - Site navigation includes "Tools" link pointing to /tools/dockerfile-analyzer/
  - SoftwareApplication JSON-LD structured data on tool page
  - BreadcrumbList JSON-LD on tool page (rule pages already have it from Phase 25)
  - Visual breadcrumb navigation on tool page
  - /tools/ redirect page (fixes Phase 25 breadcrumb links)
  - Homepage callout section linking to Dockerfile Analyzer
  - Optimized meta description with "Dockerfile linter" keyword
  - All 40 Dockerfile Analyzer URLs in sitemap
  - ScoreGauge accessibility fix (role="status")
  - Lighthouse scores 90+ across all categories
  </what-built>
  <how-to-verify>
  1. Run `npx astro dev` and visit http://localhost:4321/
  2. **Header navigation**: Verify "Tools" appears between "Beauty Index" and "Projects" in the top nav
  3. Click "Tools" -- should navigate to /tools/dockerfile-analyzer/
  4. **Tool page**: Verify:
     - Visual breadcrumbs show "Home / Tools / Dockerfile Analyzer" above the h1
     - View page source: search for "SoftwareApplication" to confirm JSON-LD
     - View page source: search for "BreadcrumbList" to confirm breadcrumb JSON-LD
  5. **Breadcrumb links**: Click "Tools" in the breadcrumb trail -- should redirect to /tools/dockerfile-analyzer/ (via /tools/ 301 redirect)
  6. Click "Home" in the breadcrumb -- should go to homepage
  7. **Homepage**: Scroll down to verify the Dockerfile Analyzer callout appears after the Beauty Index callout
  8. Click the Dockerfile Analyzer callout -- should navigate to /tools/dockerfile-analyzer/
  9. **Rule page**: Navigate to any rule (e.g., /tools/dockerfile-analyzer/rules/dl3006/) -- verify breadcrumbs show the full hierarchy
  10. **Mobile**: Resize browser to mobile width -- verify "Tools" appears in the hamburger menu
  </how-to-verify>
  <resume-signal>Type "approved" to complete Phase 26, or describe any issues to fix.</resume-signal>
</task>

</tasks>

<verification>
- `npx astro build` completes with zero errors
- Lighthouse scores documented for tool page and rule page (target: 90+ on all categories)
- ScoreGauge has `role="status"` on overlay div
- All navigation, breadcrumb, JSON-LD, and accessibility elements confirmed
- All Phase 26 requirements (NAV-01, NAV-02, SEO-01 through SEO-06) satisfied
</verification>

<success_criteria>
- Lighthouse Performance, Accessibility, Best Practices, and SEO all score 90+ on tool page
- ScoreGauge announces score changes to screen readers via role="status"
- Keyboard navigation works through editor area (Tab does not trap), results panel, and rule pages
- All structured data, breadcrumbs, and meta descriptions verified in built HTML
- User visually confirms navigation, homepage callout, breadcrumbs, and structured data
</success_criteria>

<output>
After completion, create `.planning/phases/26-seo-navigation-launch-readiness/26-03-SUMMARY.md`
</output>
