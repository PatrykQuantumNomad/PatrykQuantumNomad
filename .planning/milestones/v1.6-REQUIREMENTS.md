# Requirements Archive: v1.6 Docker Compose Validator

**Archived:** 2026-02-23
**Status:** SHIPPED

For current requirements, see `.planning/REQUIREMENTS.md`.

---

## v1.6 Requirements

Requirements for Docker Compose Validator milestone. Each maps to roadmap phases.

### Editor Foundation

- [x] **EDIT-01**: CodeMirror 6 editor with YAML syntax highlighting via @codemirror/lang-yaml
- [x] **EDIT-02**: Analyze button triggers lint cycle (not real-time as-you-type)
- [x] **EDIT-03**: Pre-loaded sample docker-compose.yml with deliberate issues across all 5 rule categories
- [x] **EDIT-04**: Keyboard shortcut (Cmd/Ctrl+Enter) to trigger analysis
- [x] **EDIT-05**: Dark-only editor theme matching site aesthetic (reuse existing editor-theme.ts pattern)
- [x] **EDIT-06**: Responsive layout — stacked on mobile, side-by-side on desktop
- [x] **EDIT-07**: React island with `client:only="react"` directive
- [x] **EDIT-08**: View Transitions lifecycle — destroy/recreate EditorView on navigation

### YAML Parsing & Schema Validation

- [x] **PARSE-01**: YAML parsing via `yaml` package (eemeli) with YAML 1.1 mode for merge key support
- [x] **PARSE-02**: LineCounter integration for mapping validation errors to source line numbers
- [x] **PARSE-03**: Variable interpolation normalizer — handle ${VAR:-default} patterns gracefully
- [x] **PARSE-04**: compose-spec JSON Schema validation via ajv v8 with Draft-07 support
- [x] **PARSE-05**: Human-readable error messages from ajv oneOf/anyOf validation failures
- [x] **PARSE-06**: compose-spec schema bundled statically at build time (not fetched at runtime)

### Schema Rules

- [x] **SCHEMA-01**: CV-S001 — Invalid YAML syntax detection with line-level error reporting
- [x] **SCHEMA-02**: CV-S002 — Unknown top-level property detection
- [x] **SCHEMA-03**: CV-S003 — Unknown service property detection
- [x] **SCHEMA-04**: CV-S004 — Invalid port format validation
- [x] **SCHEMA-05**: CV-S005 — Invalid volume format validation
- [x] **SCHEMA-06**: CV-S006 — Invalid duration format in healthcheck intervals and timeouts
- [x] **SCHEMA-07**: CV-S007 — Invalid restart policy values
- [x] **SCHEMA-08**: CV-S008 — Invalid depends_on condition values

### Semantic Rules

- [x] **SEM-01**: CV-M001 — Duplicate exported host ports between services
- [x] **SEM-02**: CV-M002 — Circular depends_on detection via topological sort
- [x] **SEM-03**: CV-M003 — Undefined network reference
- [x] **SEM-04**: CV-M004 — Undefined volume reference
- [x] **SEM-05**: CV-M005 — Undefined secret reference
- [x] **SEM-06**: CV-M006 — Undefined config reference
- [x] **SEM-07**: CV-M007 — Orphan network definition
- [x] **SEM-08**: CV-M008 — Orphan volume definition
- [x] **SEM-09**: CV-M009 — Orphan secret definition
- [x] **SEM-10**: CV-M010 — depends_on service_healthy without healthcheck on target
- [x] **SEM-11**: CV-M011 — Self-referencing dependency
- [x] **SEM-12**: CV-M012 — Dependency on undefined service
- [x] **SEM-13**: CV-M013 — Duplicate container names across services
- [x] **SEM-14**: CV-M014 — Port range overlap between services
- [x] **SEM-15**: CV-M015 — Invalid image reference format

### Security Rules

- [x] **SEC-01**: CV-C001 — Privileged mode enabled (CWE-250)
- [x] **SEC-02**: CV-C002 — Docker socket mounted in volumes (CWE-250)
- [x] **SEC-03**: CV-C003 — Host network mode bypassing isolation
- [x] **SEC-04**: CV-C004 — Host PID mode exposing host processes
- [x] **SEC-05**: CV-C005 — Host IPC mode sharing memory
- [x] **SEC-06**: CV-C006 — Dangerous capabilities added (SYS_ADMIN, NET_ADMIN, ALL)
- [x] **SEC-07**: CV-C007 — Default capabilities not dropped
- [x] **SEC-08**: CV-C008 — Secrets in environment variables
- [x] **SEC-09**: CV-C009 — Unbound port interface
- [x] **SEC-10**: CV-C010 — Missing no-new-privileges security option
- [x] **SEC-11**: CV-C011 — Writable filesystem
- [x] **SEC-12**: CV-C012 — Seccomp disabled
- [x] **SEC-13**: CV-C013 — SELinux disabled
- [x] **SEC-14**: CV-C014 — Image uses latest or no tag

### Best Practice Rules

- [x] **BP-01**: CV-B001 — Missing healthcheck definition
- [x] **BP-02**: CV-B002 — No restart policy set
- [x] **BP-03**: CV-B003 — No resource limits
- [x] **BP-04**: CV-B004 — Image tag not pinned
- [x] **BP-05**: CV-B005 — No logging configuration
- [x] **BP-06**: CV-B006 — Deprecated version field present
- [x] **BP-07**: CV-B007 — Missing top-level project name field
- [x] **BP-08**: CV-B008 — Both build and image specified
- [x] **BP-09**: CV-B009 — Anonymous volume usage
- [x] **BP-10**: CV-B010 — No memory reservation alongside limits
- [x] **BP-11**: CV-B011 — Healthcheck timeout exceeds interval
- [x] **BP-12**: CV-B012 — Default network only

### Style Rules

- [x] **STYLE-01**: CV-F001 — Services not alphabetically ordered
- [x] **STYLE-02**: CV-F002 — Ports not quoted (YAML base-60 risk)
- [x] **STYLE-03**: CV-F003 — Inconsistent quoting in port values

### Scoring

- [x] **SCORE-01**: Category-weighted scoring (Security 30%, Semantic 25%, Best Practice 20%, Schema 15%, Style 10%)
- [x] **SCORE-02**: Overall 0-100 score with letter grade (A+ through F)
- [x] **SCORE-03**: Per-category sub-scores displayed alongside aggregate
- [x] **SCORE-04**: Diminishing returns formula

### Results Display

- [x] **RESULT-01**: Inline CodeMirror annotations
- [x] **RESULT-02**: Score gauge component
- [x] **RESULT-03**: Category breakdown panel
- [x] **RESULT-04**: Violation list grouped by severity
- [x] **RESULT-05**: Click-to-navigate from results to editor line
- [x] **RESULT-06**: Clean compose file empty state
- [x] **RESULT-07**: Tabbed results panel

### Dependency Graph

- [x] **GRAPH-01**: Interactive service dependency graph using React Flow with dagre layout
- [x] **GRAPH-02**: Service nodes with name, image, and port summary
- [x] **GRAPH-03**: Directed edges for depends_on relationships with condition labels
- [x] **GRAPH-04**: Cycle detection with red-highlighted cycle edges
- [x] **GRAPH-05**: Network membership color-coding on nodes
- [x] **GRAPH-06**: Zoom, pan, and drag interaction controls
- [x] **GRAPH-07**: React Flow lazy-loaded to maintain Lighthouse 90+ performance

### Shareability

- [x] **SHARE-01**: Score badge download as PNG image
- [x] **SHARE-02**: URL state encoding via lz-string
- [x] **SHARE-03**: Web Share API / Clipboard API / text URL fallback

### Rule Documentation

- [x] **DOC-01**: Per-rule documentation pages at /tools/compose-validator/rules/[code]
- [x] **DOC-02**: Each rule page includes explanation, fix suggestion, before/after code, related rules
- [x] **DOC-03**: Rule pages generated via getStaticPaths from rule registry
- [x] **DOC-04**: SEO-optimized meta descriptions for each rule page

### Site Integration

- [x] **SITE-01**: Header navigation link
- [x] **SITE-02**: Homepage callout
- [x] **SITE-03**: Tools page card
- [x] **SITE-04**: JSON-LD SoftwareApplication structured data
- [x] **SITE-05**: BreadcrumbList JSON-LD on tool and rule pages
- [x] **SITE-06**: All tool and rule pages in sitemap
- [x] **SITE-07**: Build-time OG image via Satori + Sharp

### Content

- [x] **CONTENT-01**: Companion blog post covering Docker Compose best practices
- [x] **CONTENT-02**: Bidirectional cross-links between blog post and tool page

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| PARSE-01 through PARSE-06 | Phase 33 | Complete |
| SCHEMA-01 through SCHEMA-08 | Phase 33 | Complete |
| SEM-01 through SEM-15 | Phase 34 | Complete |
| SEC-01 through SEC-14 | Phase 34 | Complete |
| BP-01 through BP-12 | Phase 34 | Complete |
| STYLE-01 through STYLE-03 | Phase 34 | Complete |
| SCORE-01 through SCORE-04 | Phase 34 | Complete |
| EDIT-01 through EDIT-08 | Phase 35 | Complete |
| RESULT-01 through RESULT-07 | Phase 36 | Complete |
| GRAPH-01 through GRAPH-07 | Phase 36 | Complete |
| SHARE-01 through SHARE-03 | Phase 37 | Complete |
| DOC-01 through DOC-04 | Phase 38 | Complete |
| SITE-01 through SITE-06 | Phase 39 | Complete |
| SITE-07 | Phase 40 | Complete |
| CONTENT-01, CONTENT-02 | Phase 40 | Complete |

**Coverage:**
- v1.6 requirements: 100 total
- Shipped: 100 of 100
- Adjusted: 0
- Dropped: 0

---
*Archived: 2026-02-23 as part of v1.6 milestone completion*
