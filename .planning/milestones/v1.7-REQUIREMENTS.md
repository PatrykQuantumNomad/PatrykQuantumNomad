# Requirements Archive: v1.7 Kubernetes Manifest Analyzer

**Archived:** 2026-02-23
**Status:** SHIPPED

For current requirements, see `.planning/REQUIREMENTS.md`.

---

## Foundation & Parsing

- [x] **PARSE-01**: Multi-document YAML parsing splits input on `---` separators and parses each document independently with source range preservation
- [x] **PARSE-02**: Per-document apiVersion/kind detection identifies resource type from each parsed document
- [x] **PARSE-03**: GVK registry maps valid apiVersion/kind combinations to the 19 supported resource types
- [x] **PARSE-04**: Resource Registry builds an in-memory index of all parsed resources by kind, name, namespace, and labels for cross-resource validation
- [x] **PARSE-05**: Resource summary displays count of each resource type found
- [x] **PARSE-06**: YAML syntax errors reported with accurate line numbers in the original editor content

## Schema Validation (10 rules)

- [x] **SCHEMA-01**: Per-resource-type JSON Schema validation for 18 K8s resource types using K8s 1.31 schemas
- [x] **SCHEMA-02**: Schema validators pre-compiled via ajv standalone for bundle size efficiency
- [x] **SCHEMA-03**: KA-S001 -- Invalid YAML syntax (error)
- [x] **SCHEMA-04**: KA-S002 -- Missing apiVersion field (error)
- [x] **SCHEMA-05**: KA-S003 -- Missing kind field (error)
- [x] **SCHEMA-06**: KA-S004 -- Unknown apiVersion/kind combination (error)
- [x] **SCHEMA-07**: KA-S005 -- Schema validation failure per resource type (error)
- [x] **SCHEMA-08**: KA-S006 -- Deprecated API version (warning)
- [x] **SCHEMA-09**: KA-S007 -- Missing metadata.name (error)
- [x] **SCHEMA-10**: KA-S008 -- Invalid metadata.name format (warning)
- [x] **SCHEMA-11**: KA-S009 -- Invalid label key/value format (warning)
- [x] **SCHEMA-12**: KA-S010 -- Empty document in multi-doc YAML (info)

## Security Rules (20 rules)

- [x] **SEC-01**: KA-C001 -- Container runs as privileged (error) -- PSS Baseline
- [x] **SEC-02**: KA-C002 -- Privilege escalation allowed (error) -- PSS Restricted
- [x] **SEC-03**: KA-C003 -- Container runs as root (warning) -- PSS Restricted
- [x] **SEC-04**: KA-C004 -- Missing runAsNonRoot (warning) -- PSS Restricted
- [x] **SEC-05**: KA-C005 -- Running with UID 0 (error) -- PSS Restricted
- [x] **SEC-06**: KA-C006 -- Host PID namespace shared (error) -- PSS Baseline
- [x] **SEC-07**: KA-C007 -- Host IPC namespace shared (error) -- PSS Baseline
- [x] **SEC-08**: KA-C008 -- Host network enabled (warning) -- PSS Baseline
- [x] **SEC-09**: KA-C009 -- Host port specified (info) -- PSS Baseline
- [x] **SEC-10**: KA-C010 -- Dangerous capabilities (error) -- PSS Baseline/Restricted
- [x] **SEC-11**: KA-C011 -- Capabilities not dropped (warning) -- PSS Restricted
- [x] **SEC-12**: KA-C012 -- Filesystem not read-only (warning)
- [x] **SEC-13**: KA-C013 -- Missing seccomp profile (warning) -- PSS Baseline
- [x] **SEC-14**: KA-C014 -- Sensitive host path mounted (error) -- PSS Baseline
- [x] **SEC-15**: KA-C015 -- Docker socket mounted (error)
- [x] **SEC-16**: KA-C016 -- ServiceAccount token auto-mounted (warning)
- [x] **SEC-17**: KA-C017 -- Default ServiceAccount used (warning)
- [x] **SEC-18**: KA-C018 -- Secrets in environment variables (warning)
- [x] **SEC-19**: KA-C019 -- Default namespace used (info)
- [x] **SEC-20**: KA-C020 -- Missing security context entirely (warning)

## Reliability Rules (12 rules)

- [x] **REL-01**: KA-R001 -- Missing liveness probe (warning)
- [x] **REL-02**: KA-R002 -- Missing readiness probe (warning)
- [x] **REL-03**: KA-R003 -- Identical liveness and readiness probes (warning)
- [x] **REL-04**: KA-R004 -- Single replica Deployment (warning)
- [x] **REL-05**: KA-R005 -- Missing PodDisruptionBudget (info)
- [x] **REL-06**: KA-R006 -- No rolling update strategy (warning)
- [x] **REL-07**: KA-R007 -- Missing pod anti-affinity (info)
- [x] **REL-08**: KA-R008 -- Missing topology spread constraint (info)
- [x] **REL-09**: KA-R009 -- Image uses latest or no tag (warning)
- [x] **REL-10**: KA-R010 -- Image pull policy not Always (info)
- [x] **REL-11**: KA-R011 -- Selector/template label mismatch (error)
- [x] **REL-12**: KA-R012 -- CronJob missing deadline (warning)

## Best Practice Rules (12 rules)

- [x] **BP-01**: KA-B001 -- Missing CPU requests (warning)
- [x] **BP-02**: KA-B002 -- Missing CPU limits (warning)
- [x] **BP-03**: KA-B003 -- Missing memory requests (warning)
- [x] **BP-04**: KA-B004 -- Missing memory limits (warning)
- [x] **BP-05**: KA-B005 -- Missing required labels (info)
- [x] **BP-06**: KA-B006 -- Missing namespace (info)
- [x] **BP-07**: KA-B007 -- SSH port exposed (info)
- [x] **BP-08**: KA-B008 -- NodePort service type used (info)
- [x] **BP-09**: KA-B009 -- Liveness probe port not in container ports (warning)
- [x] **BP-10**: KA-B010 -- Readiness probe port not in container ports (warning)
- [x] **BP-11**: KA-B011 -- Missing priorityClassName (info)
- [x] **BP-12**: KA-B012 -- Duplicate environment variable keys (warning)

## Cross-Resource Validation (8 rules)

- [x] **XREF-01**: KA-X001 -- Service selector matches no Pod template (warning)
- [x] **XREF-02**: KA-X002 -- Ingress references undefined Service (warning)
- [x] **XREF-03**: KA-X003 -- ConfigMap reference not found in file (info)
- [x] **XREF-04**: KA-X004 -- Secret reference not found in file (info)
- [x] **XREF-05**: KA-X005 -- PVC reference not found in file (info)
- [x] **XREF-06**: KA-X006 -- ServiceAccount reference not found in file (warning)
- [x] **XREF-07**: KA-X007 -- NetworkPolicy selector matches no Pod (info)
- [x] **XREF-08**: KA-X008 -- HPA targets non-existent resource (warning)

## RBAC Analysis (5 rules)

- [x] **RBAC-01**: KA-A001 -- Wildcard permissions in Role/ClusterRole (error) -- CIS 5.1.3
- [x] **RBAC-02**: KA-A002 -- cluster-admin RoleBinding (error) -- CIS 5.1.1
- [x] **RBAC-03**: KA-A003 -- Pod exec/attach permissions (warning)
- [x] **RBAC-04**: KA-A004 -- Secret access permissions (warning) -- CIS 5.1.2
- [x] **RBAC-05**: KA-A005 -- Pod creation permissions (warning) -- CIS 5.1.4

## Scoring

- [x] **SCORE-01**: Category-weighted scoring -- Security 35%, Reliability 20%, Best Practice 20%, Schema 15%, Cross-Resource 10%
- [x] **SCORE-02**: Overall 0-100 score with letter grade (A+ through F)
- [x] **SCORE-03**: Per-category sub-scores alongside aggregate
- [x] **SCORE-04**: RBAC rules scored under Security category
- [x] **SCORE-05**: PSS profile compliance summary

## Editor & UI

- [x] **UI-01**: CodeMirror 6 YAML editor with dark theme
- [x] **UI-02**: Pre-loaded sample K8s manifest with deliberate issues
- [x] **UI-03**: Analyze button triggers analysis cycle
- [x] **UI-04**: Keyboard shortcut Cmd/Ctrl+Enter
- [x] **UI-05**: Inline CodeMirror annotations
- [x] **UI-06**: Score gauge component (SVG circular gauge)
- [x] **UI-07**: Category breakdown panel
- [x] **UI-08**: Violation list grouped by severity
- [x] **UI-09**: Click-to-navigate from results to editor line
- [x] **UI-10**: Clean manifest empty state
- [x] **UI-11**: Responsive layout
- [x] **UI-12**: React island with client:only="react"
- [x] **UI-13**: View Transitions lifecycle
- [x] **UI-14**: Nanostore bridge
- [x] **UI-15**: Tabbed results panel (Results | Graph)
- [x] **UI-16**: Resource summary panel

## Resource Relationship Graph

- [x] **GRAPH-01**: Interactive React Flow dependency graph with dagre layout
- [x] **GRAPH-02**: Node types color-coded by resource kind
- [x] **GRAPH-03**: Edge types represent references
- [x] **GRAPH-04**: Dangling references shown as red dashed edges
- [x] **GRAPH-05**: React Flow lazy-loaded via React.lazy()
- [x] **GRAPH-06**: Graph data derived from cross-resource validation

## Shareability

- [x] **SHARE-01**: Score badge download as PNG
- [x] **SHARE-02**: URL state encoding with #k8s= prefix
- [x] **SHARE-03**: 3-tier share fallback

## Rule Documentation

- [x] **DOCS-01**: 67 per-rule documentation pages
- [x] **DOCS-02**: Each rule page includes explanation, fix, before/after code, related rules
- [x] **DOCS-03**: PSS profile tags and CIS Benchmark references
- [x] **DOCS-04**: SEO-optimized meta descriptions

## Site Integration

- [x] **SITE-01**: Tool page at /tools/k8s-analyzer/
- [x] **SITE-02**: Header navigation link
- [x] **SITE-03**: Homepage callout
- [x] **SITE-04**: Tools page card
- [x] **SITE-05**: JSON-LD structured data
- [x] **SITE-06**: Breadcrumb navigation
- [x] **SITE-07**: All pages in sitemap
- [x] **SITE-08**: Build-time OG image
- [x] **SITE-09**: LLMs.txt updated

## Content

- [x] **CONTENT-01**: Companion blog post with rule links
- [x] **CONTENT-02**: Blog post covers security, reliability, best practices with ~20 rule cross-links

## Quality

- [x] **QA-01**: Lighthouse 90+ on all K8s Analyzer pages
- [x] **QA-02**: WCAG 2.1 AA accessibility
- [x] **QA-03**: Responsive design across mobile, tablet, desktop

---

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| PARSE-01 through PARSE-06 | Phase 41 | Complete |
| SCHEMA-01 through SCHEMA-12 | Phase 41 | Complete |
| SEC-01 through SEC-20 | Phase 42 | Complete |
| SCORE-05 | Phase 42 | Complete |
| REL-01 through REL-12 | Phase 43 | Complete |
| BP-01 through BP-12 | Phase 43 | Complete |
| XREF-01 through XREF-08 | Phase 44 | Complete |
| RBAC-01 through RBAC-05 | Phase 44 | Complete |
| SCORE-04 | Phase 44 | Complete |
| UI-01 through UI-16 | Phase 45 | Complete |
| SHARE-01 through SHARE-03 | Phase 45 | Complete |
| SCORE-01 through SCORE-03 | Phase 45 | Complete |
| GRAPH-01 through GRAPH-06 | Phase 46 | Complete |
| DOCS-01 through DOCS-04 | Phase 47 | Complete |
| SITE-01 through SITE-09 | Phase 47 | Complete |
| CONTENT-01, CONTENT-02 | Phase 47 | Complete |
| QA-01 through QA-03 | Phase 47 | Complete |

---

## Milestone Summary

**Shipped:** 123 of 123 requirements
**Adjusted:** None
**Dropped:** None

---
*Archived: 2026-02-23 as part of v1.7 milestone completion*
