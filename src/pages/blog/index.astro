---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import BlogCard from '../../components/BlogCard.astro';

const posts = await getCollection('blog', ({ data }) => {
  return import.meta.env.PROD ? data.draft !== true : true;
});

const sortedPosts = posts.sort(
  (a, b) => b.data.publishedDate.valueOf() - a.data.publishedDate.valueOf()
);
---

<Layout
  title="Blog â€” Patryk Golabek | Cloud-Native & AI/ML Articles"
  description="Technical articles on Kubernetes, cloud-native architecture, AI/ML engineering, LLM agents, RAG pipelines, and platform engineering by Patryk Golabek."
>
  <section class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
    <h1 class="text-3xl sm:text-4xl font-heading font-bold mb-8">Blog</h1>
    {sortedPosts.length > 0 ? (
      <div class="space-y-8">
        {sortedPosts.map((post) => (
          <BlogCard post={post} />
        ))}
      </div>
    ) : (
      <p class="text-[var(--color-text-secondary)]">No posts yet. Check back soon!</p>
    )}
  </section>
</Layout>
