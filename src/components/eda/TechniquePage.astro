---
import EDALayout from '../../layouts/EDALayout.astro';
import EdaBreadcrumb from './EdaBreadcrumb.astro';
import BreadcrumbJsonLd from '../BreadcrumbJsonLd.astro';

interface Props {
  title: string;
  description: string;
  category: string;
  nistSection: string;
  relatedTechniques?: Array<{ slug: string; name: string }>;
  useKatex?: boolean;
}

const { title, description, category, nistSection, relatedTechniques = [], useKatex = false } = Astro.props;

const categorySlug = category.toLowerCase().replace(/\s+/g, '-');
---

<EDALayout title={`${title} | EDA Visual Encyclopedia`} description={description} useKatex={useKatex}>
  <BreadcrumbJsonLd crumbs={[
    { name: 'Home', url: 'https://patrykgolabek.dev/' },
    { name: 'EDA', url: 'https://patrykgolabek.dev/eda/' },
    { name: category, url: `https://patrykgolabek.dev/eda/${categorySlug}/` },
    { name: title, url: `https://patrykgolabek.dev/eda/techniques/${title.toLowerCase().replace(/\s+/g, '-')}/` },
  ]} />

  <article class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
    <EdaBreadcrumb category={category} techniqueName={title} />

    <header class="mb-10">
      <h1 class="text-3xl sm:text-4xl font-heading font-bold mb-4">{title}</h1>
      <p class="text-sm text-[var(--color-text-secondary)]">NIST/SEMATECH Section {nistSection}</p>
    </header>

    {/* Named slots for content sections */}
    <slot name="plot" />
    <slot name="description" />
    <slot name="formula" />
    <slot name="code" />
    <slot name="interpretation" />

    {/* Related techniques */}
    {relatedTechniques.length > 0 && (
      <section class="mt-12 pt-8 border-t border-[var(--color-border)]">
        <h2 class="text-xl font-heading font-bold mb-4">Related Techniques</h2>
        <div class="flex flex-wrap gap-3">
          {relatedTechniques.map((t) => (
            <a href={`/eda/techniques/${t.slug}/`}
               class="inline-flex items-center px-3 py-1.5 rounded-full text-sm bg-[var(--color-accent)]/10 text-[var(--color-accent)] hover:bg-[var(--color-accent)]/20 transition-colors">
              {t.name}
            </a>
          ))}
        </div>
      </section>
    )}
  </article>
</EDALayout>
